<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Codec.Candid.Subtype</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Codec.Candid.Subtype.html#isSubtypeOf"><span class="hs-identifier">isSubtypeOf</span></a></span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.Subtype.html#SubTypeM"><span class="hs-identifier">SubTypeM</span></a></span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.Subtype.html#runSubTypeM"><span class="hs-identifier">runSubTypeM</span></a></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.Subtype.html#isSubtypeOfM"><span class="hs-identifier">isSubtypeOfM</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Prettyprinter</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Bifunctor</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Tuple</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Control.Monad.State.Lazy</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Control.Monad.Except</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Control.Monad.Trans.Except</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html"><span class="hs-identifier">Codec.Candid.Types</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Candid.TypTable.html"><span class="hs-identifier">Codec.Candid.TypTable</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">type</span><span> </span><span id="Memo"><span class="annot"><a href="Codec.Candid.Subtype.html#Memo"><span class="hs-identifier hs-var">Memo</span></a></span></span><span> </span><span id="local-6989586621679397725"><span class="annot"><a href="#local-6989586621679397725"><span class="hs-identifier hs-type">k1</span></a></span></span><span> </span><span id="local-6989586621679397724"><span class="annot"><a href="#local-6989586621679397724"><span class="hs-identifier hs-type">k2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397725"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397724"><span class="hs-identifier hs-type">k2</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>     </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397724"><span class="hs-identifier hs-type">k2</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397725"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">type</span><span> </span><span id="SubTypeM"><span class="annot"><a href="Codec.Candid.Subtype.html#SubTypeM"><span class="hs-identifier hs-var">SubTypeM</span></a></span></span><span> </span><span id="local-6989586621679397723"><span class="annot"><a href="#local-6989586621679397723"><span class="hs-identifier hs-type">k1</span></a></span></span><span> </span><span id="local-6989586621679397722"><span class="annot"><a href="#local-6989586621679397722"><span class="hs-identifier hs-type">k2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Subtype.html#Memo"><span class="hs-identifier hs-type">Memo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397723"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397722"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span id="local-6989586621679397856"><span id="local-6989586621679397857"><span id="local-6989586621679397858"><span class="annot"><a href="Codec.Candid.Subtype.html#runSubTypeM"><span class="hs-identifier hs-type">runSubTypeM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397858"><span class="hs-identifier hs-type">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397857"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Codec.Candid.Subtype.html#SubTypeM"><span class="hs-identifier hs-type">SubTypeM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397858"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397857"><span class="hs-identifier hs-type">k2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397856"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397856"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-32"></span><span id="runSubTypeM"><span class="annot"><span class="annottext">runSubTypeM :: SubTypeM k1 k2 a -&gt; Either String a
</span><a href="Codec.Candid.Subtype.html#runSubTypeM"><span class="hs-identifier hs-var hs-var">runSubTypeM</span></a></span></span><span> </span><span id="local-6989586621679397721"><span class="annot"><span class="annottext">SubTypeM k1 k2 a
</span><a href="#local-6989586621679397721"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State (Memo k1 k2) (Either String a)
-&gt; Memo k1 k2 -&gt; Either String a
forall s a. State s a -&gt; s -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">evalState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SubTypeM k1 k2 a -&gt; State (Memo k1 k2) (Either String a)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href=".."><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">SubTypeM k1 k2 a
</span><a href="#local-6989586621679397721"><span class="hs-identifier hs-var">act</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ())
forall a. Monoid a =&gt; a
</span><a href=".."><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ())
forall a. Monoid a =&gt; a
</span><a href=".."><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-comment">-- | Returns 'Right' if the first argument is a subtype of the second, or</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- returns 'Left' with an explanation if not</span><span>
</span><span id="line-36"></span><span id="local-6989586621679397717"><span id="local-6989586621679397718"><span class="annot"><a href="Codec.Candid.Subtype.html#isSubtypeOf"><span class="hs-identifier hs-type">isSubtypeOf</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397718"><span class="hs-identifier hs-type">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397717"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397718"><span class="hs-identifier hs-type">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397717"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397718"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397717"><span class="hs-identifier hs-type">k2</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-41"></span><span id="isSubtypeOf"><span class="annot"><span class="annottext">isSubtypeOf :: Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; Either String ()
</span><a href="Codec.Candid.Subtype.html#isSubtypeOf"><span class="hs-identifier hs-var hs-var">isSubtypeOf</span></a></span></span><span> </span><span id="local-6989586621679397716"><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397716"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679397715"><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397715"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SubTypeM k1 k2 () -&gt; Either String ()
forall k1 k2 a.
(Ord k1, Ord k2) =&gt;
SubTypeM k1 k2 a -&gt; Either String a
</span><a href="Codec.Candid.Subtype.html#runSubTypeM"><span class="hs-identifier hs-var">runSubTypeM</span></a></span><span> </span><span class="annot"><span class="annottext">(SubTypeM k1 k2 () -&gt; Either String ())
-&gt; SubTypeM k1 k2 () -&gt; Either String ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
forall k1 k2.
(Pretty k1, Pretty k2, Ord k1, Ord k2) =&gt;
Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#isSubtypeOfM"><span class="hs-identifier hs-var">isSubtypeOfM</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397716"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397715"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span id="local-6989586621679397850"><span id="local-6989586621679397852"><span class="annot"><a href="Codec.Candid.Subtype.html#isSubtypeOfM"><span class="hs-identifier hs-type">isSubtypeOfM</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397852"><span class="hs-identifier hs-type">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397850"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397852"><span class="hs-identifier hs-type">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397850"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397852"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397850"><span class="hs-identifier hs-type">k2</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Codec.Candid.Subtype.html#SubTypeM"><span class="hs-identifier hs-type">SubTypeM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397852"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397850"><span class="hs-identifier hs-type">k2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-48"></span><span id="isSubtypeOfM"><span class="annot"><span class="annottext">isSubtypeOfM :: Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#isSubtypeOfM"><span class="hs-identifier hs-var hs-var">isSubtypeOfM</span></a></span></span><span> </span><span id="local-6989586621679397714"><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397714"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679397713"><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397713"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
forall k1 k2.
(Pretty k1, Pretty k2, Ord k1, Ord k2) =&gt;
Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#memo"><span class="hs-identifier hs-var">memo</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397714"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397713"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span id="local-6989586621679397735"><span id="local-6989586621679397736"><span id="local-6989586621679397737"><span class="annot"><a href="Codec.Candid.Subtype.html#flipM"><span class="hs-identifier hs-type">flipM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Candid.Subtype.html#SubTypeM"><span class="hs-identifier hs-type">SubTypeM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397737"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397736"><span class="hs-identifier hs-type">k2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397735"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Candid.Subtype.html#SubTypeM"><span class="hs-identifier hs-type">SubTypeM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397736"><span class="hs-identifier hs-type">k2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397737"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397735"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-51"></span><span id="flipM"><span class="annot"><span class="annottext">flipM :: SubTypeM k1 k2 a -&gt; SubTypeM k2 k1 a
</span><a href="Codec.Candid.Subtype.html#flipM"><span class="hs-identifier hs-var hs-var">flipM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span id="local-6989586621679397708"><span class="annot"><span class="annottext">Memo k1 k2 -&gt; Identity (Either String a, Memo k1 k2)
</span><a href="#local-6989586621679397708"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT
  (Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()),
   Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ()))
  Identity
  (Either String a)
-&gt; SubTypeM k2 k1 a
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><a href=".."><span class="hs-identifier hs-var">ExceptT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()),
  Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ()))
 -&gt; Identity
      (Either String a,
       (Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()),
        Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ()))))
-&gt; StateT
     (Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()),
      Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ()))
     Identity
     (Either String a)
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; StateT s m a
</span><a href=".."><span class="hs-identifier hs-var">StateT</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()),
 Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ()))
-&gt; Identity
     (Either String a,
      (Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()),
       Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ())))
</span><a href="#local-6989586621679397707"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-53"></span><span>    </span><span id="local-6989586621679397707"><span class="annot"><span class="annottext">f' :: (Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()),
 Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ()))
-&gt; Identity
     (Either String a,
      (Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()),
       Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ())))
</span><a href="#local-6989586621679397707"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397706"><span class="annot"><span class="annottext">Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ())
</span><a href="#local-6989586621679397706"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679397705"><span class="annot"><span class="annottext">Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ())
</span><a href="#local-6989586621679397705"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Memo k1 k2
 -&gt; (Map
       (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()),
     Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ())))
-&gt; (Either String a, Memo k1 k2)
-&gt; (Either String a,
    (Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()),
     Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ())))
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><a href=".."><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">Memo k1 k2
-&gt; (Map
      (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()),
    Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ()))
forall a b. (a, b) -&gt; (b, a)
</span><a href=".."><span class="hs-identifier hs-var">swap</span></a></span><span> </span><span class="annot"><span class="annottext">((Either String a, Memo k1 k2)
 -&gt; (Either String a,
     (Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()),
      Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ()))))
-&gt; Identity (Either String a, Memo k1 k2)
-&gt; Identity
     (Either String a,
      (Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()),
       Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ())))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Memo k1 k2 -&gt; Identity (Either String a, Memo k1 k2)
</span><a href="#local-6989586621679397708"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ())
</span><a href="#local-6989586621679397705"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ())
</span><a href="#local-6989586621679397706"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- f (m2,m1) &gt;&gt;= \case (r, (m2',m1')) -&gt; pure (r, (m1', m2'))</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span id="local-6989586621679397700"><span id="local-6989586621679397701"><span class="annot"><a href="Codec.Candid.Subtype.html#memo"><span class="hs-identifier hs-type">memo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397701"><span class="hs-identifier hs-type">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397700"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397701"><span class="hs-identifier hs-type">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397700"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397701"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397700"><span class="hs-identifier hs-type">k2</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><a href="Codec.Candid.Subtype.html#SubTypeM"><span class="hs-identifier hs-type">SubTypeM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397701"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397700"><span class="hs-identifier hs-type">k2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span id="local-6989586621679397733"><span id="local-6989586621679397734"><span class="annot"><a href="Codec.Candid.Subtype.html#goSeq"><span class="hs-identifier hs-type">goSeq</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397734"><span class="hs-identifier hs-type">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397733"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397734"><span class="hs-identifier hs-type">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397733"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397734"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397733"><span class="hs-identifier hs-type">k2</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><a href="Codec.Candid.Subtype.html#SubTypeM"><span class="hs-identifier hs-type">SubTypeM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397734"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397733"><span class="hs-identifier hs-type">k2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- Memoization: When we see a pair for the first time,</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- we optimistically put 'True' into the map.</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- Either the following recursive call will fail (but then this optimistic</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- value wasn't a problem), or it will succeed, but then the guess was correct.</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- If it fails we put 'False' into it, to as a caching optimization</span><span>
</span><span id="line-72"></span><span id="memo"><span class="annot"><span class="annottext">memo :: Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#memo"><span class="hs-identifier hs-var hs-var">memo</span></a></span></span><span> </span><span id="local-6989586621679397697"><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397697"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679397696"><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397696"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><span class="annottext">((Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ()),
  Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()))
 -&gt; Maybe (Either String ()))
-&gt; ExceptT
     String
     (State
        (Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ()),
         Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ())))
     (Maybe (Either String ()))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type (Ref k1 Type), Type (Ref k2 Type))
-&gt; Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ())
-&gt; Maybe (Either String ())
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href=".."><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397697"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397696"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ())
 -&gt; Maybe (Either String ()))
-&gt; ((Map
       (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ()),
     Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()))
    -&gt; Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ()))
-&gt; (Map
      (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ()),
    Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()))
-&gt; Maybe (Either String ())
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href=".."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ()),
 Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ()))
-&gt; Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ())
forall a b. (a, b) -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExceptT
  String
  (State
     (Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either String ()),
      Map (Type (Ref k2 Type), Type (Ref k1 Type)) (Either String ())))
  (Maybe (Either String ()))
-&gt; (Maybe (Either String ()) -&gt; SubTypeM k1 k2 ())
-&gt; SubTypeM k1 k2 ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679397692"><span class="annot"><span class="annottext">Either String ()
</span><a href="#local-6989586621679397692"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either String () -&gt; SubTypeM k1 k2 ()
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><a href=".."><span class="hs-identifier hs-var">except</span></a></span><span> </span><span class="annot"><span class="annottext">Either String ()
</span><a href="#local-6989586621679397692"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Either String ())
</span><a href=".."><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SubTypeM k1 k2 ()
</span><a href="#local-6989586621679397690"><span class="hs-identifier hs-var">assume_ok</span></a></span><span> </span><span class="annot"><span class="annottext">SubTypeM k1 k2 () -&gt; SubTypeM k1 k2 () -&gt; SubTypeM k1 k2 ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
forall k1 k2.
(Pretty k1, Pretty k2, Ord k1, Ord k2) =&gt;
Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397697"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397696"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">SubTypeM k1 k2 ()
-&gt; (String -&gt; SubTypeM k1 k2 ()) -&gt; SubTypeM k1 k2 ()
forall (m :: * -&gt; *) e a e'.
Monad m =&gt;
ExceptT e m a -&gt; (e -&gt; ExceptT e' m a) -&gt; ExceptT e' m a
</span><a href=".."><span class="hs-operator hs-var">`catchE`</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SubTypeM k1 k2 ()
forall (m :: * -&gt; *) (p :: * -&gt; * -&gt; *) e b c b.
(MonadState
   (p (Map (Type (Ref k1 Type), Type (Ref k2 Type)) (Either e b)) c)
   m,
 Bifunctor p, MonadError e m) =&gt;
e -&gt; m b
</span><a href="#local-6989586621679397688"><span class="hs-identifier hs-var">remember_failure</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679397687"><span class="annot"><span class="annottext">remember :: a -&gt; m ()
</span><a href="#local-6989586621679397687"><span class="hs-identifier hs-var hs-var">remember</span></a></span></span><span> </span><span id="local-6989586621679397686"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397686"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(p (Map (Type (Ref k1 Type), Type (Ref k2 Type)) a) c
 -&gt; p (Map (Type (Ref k1 Type), Type (Ref k2 Type)) a) c)
-&gt; m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href=".."><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Map (Type (Ref k1 Type), Type (Ref k2 Type)) a
 -&gt; Map (Type (Ref k1 Type), Type (Ref k2 Type)) a)
-&gt; p (Map (Type (Ref k1 Type), Type (Ref k2 Type)) a) c
-&gt; p (Map (Type (Ref k1 Type), Type (Ref k2 Type)) a) c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href=".."><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type (Ref k1 Type), Type (Ref k2 Type))
-&gt; a
-&gt; Map (Type (Ref k1 Type), Type (Ref k2 Type)) a
-&gt; Map (Type (Ref k1 Type), Type (Ref k2 Type)) a
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href=".."><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397697"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397696"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679397686"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621679397690"><span class="annot"><span class="annottext">assume_ok :: SubTypeM k1 k2 ()
</span><a href="#local-6989586621679397690"><span class="hs-identifier hs-var hs-var">assume_ok</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either String () -&gt; SubTypeM k1 k2 ()
forall (p :: * -&gt; * -&gt; *) a c (m :: * -&gt; *).
(MonadState
   (p (Map (Type (Ref k1 Type), Type (Ref k2 Type)) a) c) m,
 Bifunctor p) =&gt;
a -&gt; m ()
</span><a href="#local-6989586621679397687"><span class="hs-identifier hs-var">remember</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Either String ()
forall a b. b -&gt; Either a b
</span><a href=".."><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679397688"><span class="annot"><span class="annottext">remember_failure :: e -&gt; m b
</span><a href="#local-6989586621679397688"><span class="hs-identifier hs-var hs-var">remember_failure</span></a></span></span><span> </span><span id="local-6989586621679397682"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679397682"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either e b -&gt; m ()
forall (p :: * -&gt; * -&gt; *) a c (m :: * -&gt; *).
(MonadState
   (p (Map (Type (Ref k1 Type), Type (Ref k2 Type)) a) c) m,
 Bifunctor p) =&gt;
a -&gt; m ()
</span><a href="#local-6989586621679397687"><span class="hs-identifier hs-var">remember</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e -&gt; Either e b
forall a b. a -&gt; Either a b
</span><a href=".."><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679397682"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m () -&gt; m b -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; m b
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679397682"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- Look through refs</span><span>
</span><span id="line-82"></span><span id="go"><span class="annot"><span class="annottext">go :: Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#RefT"><span class="hs-identifier hs-type">RefT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><span class="annottext">k1
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679397678"><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397678"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679397677"><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397677"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
forall k1 k2.
(Pretty k1, Pretty k2, Ord k1, Ord k2) =&gt;
Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#memo"><span class="hs-identifier hs-var">memo</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397678"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397677"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-83"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679397676"><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397676"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#RefT"><span class="hs-identifier hs-type">RefT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><span class="annottext">k2
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679397675"><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397675"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
forall k1 k2.
(Pretty k1, Pretty k2, Ord k1, Ord k2) =&gt;
Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#memo"><span class="hs-identifier hs-var">memo</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397676"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397675"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- Identity coercion for primitive values</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#NatT"><span class="hs-identifier hs-var">NatT</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#NatT"><span class="hs-identifier hs-var">NatT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#Nat8T"><span class="hs-identifier hs-var">Nat8T</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#Nat8T"><span class="hs-identifier hs-var">Nat8T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#Nat16T"><span class="hs-identifier hs-var">Nat16T</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#Nat16T"><span class="hs-identifier hs-var">Nat16T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#Nat32T"><span class="hs-identifier hs-var">Nat32T</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#Nat32T"><span class="hs-identifier hs-var">Nat32T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#Nat64T"><span class="hs-identifier hs-var">Nat64T</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#Nat64T"><span class="hs-identifier hs-var">Nat64T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#IntT"><span class="hs-identifier hs-var">IntT</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#IntT"><span class="hs-identifier hs-var">IntT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#Int8T"><span class="hs-identifier hs-var">Int8T</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#Int8T"><span class="hs-identifier hs-var">Int8T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#Int16T"><span class="hs-identifier hs-var">Int16T</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#Int16T"><span class="hs-identifier hs-var">Int16T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#Int32T"><span class="hs-identifier hs-var">Int32T</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#Int32T"><span class="hs-identifier hs-var">Int32T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#Int64T"><span class="hs-identifier hs-var">Int64T</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#Int64T"><span class="hs-identifier hs-var">Int64T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#Float32T"><span class="hs-identifier hs-var">Float32T</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#Float32T"><span class="hs-identifier hs-var">Float32T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#Float64T"><span class="hs-identifier hs-var">Float64T</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#Float64T"><span class="hs-identifier hs-var">Float64T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#BoolT"><span class="hs-identifier hs-var">BoolT</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#BoolT"><span class="hs-identifier hs-var">BoolT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#TextT"><span class="hs-identifier hs-var">TextT</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#TextT"><span class="hs-identifier hs-var">TextT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#NullT"><span class="hs-identifier hs-var">NullT</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#NullT"><span class="hs-identifier hs-var">NullT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#PrincipalT"><span class="hs-identifier hs-var">PrincipalT</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#PrincipalT"><span class="hs-identifier hs-var">PrincipalT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- Nat &lt;: Int</span><span>
</span><span id="line-104"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#NatT"><span class="hs-identifier hs-var">NatT</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#IntT"><span class="hs-identifier hs-var">IntT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- t &lt;: reserved</span><span>
</span><span id="line-107"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#ReservedT"><span class="hs-identifier hs-var">ReservedT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- empty &lt;: t</span><span>
</span><span id="line-110"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- vec t1 &lt;: vec t2</span><span>
</span><span id="line-113"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#VecT"><span class="hs-identifier hs-type">VecT</span></a></span><span> </span><span id="local-6989586621679397655"><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397655"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#VecT"><span class="hs-identifier hs-type">VecT</span></a></span><span> </span><span id="local-6989586621679397654"><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397654"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
forall k1 k2.
(Pretty k1, Pretty k2, Ord k1, Ord k2) =&gt;
Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#memo"><span class="hs-identifier hs-var">memo</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397655"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397654"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- Option: very simple</span><span>
</span><span id="line-116"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#OptT"><span class="hs-identifier hs-type">OptT</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- Records</span><span>
</span><span id="line-119"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#RecT"><span class="hs-identifier hs-type">RecT</span></a></span><span> </span><span id="local-6989586621679397651"><span class="annot"><span class="annottext">Fields (Ref k1 Type)
</span><a href="#local-6989586621679397651"><span class="hs-identifier hs-var">fs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#RecT"><span class="hs-identifier hs-type">RecT</span></a></span><span> </span><span id="local-6989586621679397650"><span class="annot"><span class="annottext">Fields (Ref k2 Type)
</span><a href="#local-6989586621679397650"><span class="hs-identifier hs-var">fs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397649"><span class="annot"><span class="annottext">m1 :: Map FieldName (Type (Ref k1 Type))
</span><a href="#local-6989586621679397649"><span class="hs-identifier hs-var hs-var">m1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fields (Ref k1 Type) -&gt; Map FieldName (Type (Ref k1 Type))
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href=".."><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">Fields (Ref k1 Type)
</span><a href="#local-6989586621679397651"><span class="hs-identifier hs-var">fs1</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397647"><span class="annot"><span class="annottext">m2 :: Map FieldName (Type (Ref k2 Type))
</span><a href="#local-6989586621679397647"><span class="hs-identifier hs-var hs-var">m2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fields (Ref k2 Type) -&gt; Map FieldName (Type (Ref k2 Type))
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href=".."><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">Fields (Ref k2 Type)
</span><a href="#local-6989586621679397650"><span class="hs-identifier hs-var">fs2</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-comment">-- Check missing fields</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">[SubTypeM k1 k2 ()] -&gt; SubTypeM k1 k2 ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><a href=".."><span class="hs-identifier hs-var">sequence_</span></a></span><span>
</span><span id="line-124"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type) -&gt; Type (Ref k2 Type)
forall a. Type (Ref a Type) -&gt; Type (Ref a Type)
</span><a href="Codec.Candid.Subtype.html#unRef"><span class="hs-identifier hs-var">unRef</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397644"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-125"></span><span>          </span><span class="annot"><a href="Codec.Candid.Types.html#OptT"><span class="hs-identifier hs-type">OptT</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>          </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#ReservedT"><span class="hs-identifier hs-var">ReservedT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>          </span><span id="local-6989586621679397643"><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397643"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SubTypeM k1 k2 ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; SubTypeM k1 k2 ()) -&gt; String -&gt; SubTypeM k1 k2 ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; String) -&gt; Doc Any -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;Missing record field&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; Doc Any -&gt; Doc Any
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href=".."><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href=".."><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679397639"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; Doc Any -&gt; Doc Any
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href=".."><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;of type&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; Doc Any -&gt; Doc Any
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href=".."><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type) -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href=".."><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397643"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397639"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679397639"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679397644"><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397644"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map FieldName (Type (Ref k2 Type)) -&gt; Fields (Ref k2 Type)
forall k a. Map k a -&gt; [(k, a)]
</span><a href=".."><span class="hs-identifier hs-var">M.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Map FieldName (Type (Ref k2 Type)) -&gt; Fields (Ref k2 Type))
-&gt; Map FieldName (Type (Ref k2 Type)) -&gt; Fields (Ref k2 Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map FieldName (Type (Ref k2 Type))
</span><a href="#local-6989586621679397647"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="annot"><span class="annottext">Map FieldName (Type (Ref k2 Type))
-&gt; Map FieldName (Type (Ref k1 Type))
-&gt; Map FieldName (Type (Ref k2 Type))
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><a href=".."><span class="hs-operator hs-var">M.\\</span></a></span><span> </span><span class="annot"><span class="annottext">Map FieldName (Type (Ref k1 Type))
</span><a href="#local-6989586621679397649"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-comment">-- Check existing fields</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="annottext">[SubTypeM k1 k2 ()] -&gt; SubTypeM k1 k2 ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><a href=".."><span class="hs-identifier hs-var">sequence_</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
forall k1 k2.
(Pretty k1, Pretty k2, Ord k1, Ord k2) =&gt;
Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#memo"><span class="hs-identifier hs-var">memo</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397636"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397635"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397634"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679397634"><span class="hs-identifier hs-var">_fn</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397636"><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397636"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679397635"><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397635"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map FieldName (Type (Ref k1 Type), Type (Ref k2 Type))
-&gt; [(FieldName, (Type (Ref k1 Type), Type (Ref k2 Type)))]
forall k a. Map k a -&gt; [(k, a)]
</span><a href=".."><span class="hs-identifier hs-var">M.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Map FieldName (Type (Ref k1 Type), Type (Ref k2 Type))
 -&gt; [(FieldName, (Type (Ref k1 Type), Type (Ref k2 Type)))])
-&gt; Map FieldName (Type (Ref k1 Type), Type (Ref k2 Type))
-&gt; [(FieldName, (Type (Ref k1 Type), Type (Ref k2 Type)))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Type (Ref k1 Type)
 -&gt; Type (Ref k2 Type) -&gt; (Type (Ref k1 Type), Type (Ref k2 Type)))
-&gt; Map FieldName (Type (Ref k1 Type))
-&gt; Map FieldName (Type (Ref k2 Type))
-&gt; Map FieldName (Type (Ref k1 Type), Type (Ref k2 Type))
forall k a b c.
Ord k =&gt;
(a -&gt; b -&gt; c) -&gt; Map k a -&gt; Map k b -&gt; Map k c
</span><a href=".."><span class="hs-identifier hs-var">M.intersectionWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map FieldName (Type (Ref k1 Type))
</span><a href="#local-6989586621679397649"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Map FieldName (Type (Ref k2 Type))
</span><a href="#local-6989586621679397647"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- Variants</span><span>
</span><span id="line-134"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#VariantT"><span class="hs-identifier hs-type">VariantT</span></a></span><span> </span><span id="local-6989586621679397631"><span class="annot"><span class="annottext">Fields (Ref k1 Type)
</span><a href="#local-6989586621679397631"><span class="hs-identifier hs-var">fs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#VariantT"><span class="hs-identifier hs-type">VariantT</span></a></span><span> </span><span id="local-6989586621679397630"><span class="annot"><span class="annottext">Fields (Ref k2 Type)
</span><a href="#local-6989586621679397630"><span class="hs-identifier hs-var">fs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397629"><span class="annot"><span class="annottext">m1 :: Map FieldName (Type (Ref k1 Type))
</span><a href="#local-6989586621679397629"><span class="hs-identifier hs-var hs-var">m1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fields (Ref k1 Type) -&gt; Map FieldName (Type (Ref k1 Type))
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href=".."><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">Fields (Ref k1 Type)
</span><a href="#local-6989586621679397631"><span class="hs-identifier hs-var">fs1</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397628"><span class="annot"><span class="annottext">m2 :: Map FieldName (Type (Ref k2 Type))
</span><a href="#local-6989586621679397628"><span class="hs-identifier hs-var hs-var">m2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fields (Ref k2 Type) -&gt; Map FieldName (Type (Ref k2 Type))
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href=".."><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">Fields (Ref k2 Type)
</span><a href="#local-6989586621679397630"><span class="hs-identifier hs-var">fs2</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="annottext">[SubTypeM k1 k2 ()] -&gt; SubTypeM k1 k2 ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><a href=".."><span class="hs-identifier hs-var">sequence_</span></a></span><span>
</span><span id="line-138"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldName
-&gt; Map FieldName (Type (Ref k2 Type)) -&gt; Maybe (Type (Ref k2 Type))
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href=".."><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679397627"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Map FieldName (Type (Ref k2 Type))
</span><a href="#local-6989586621679397628"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-139"></span><span>            </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679397626"><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397626"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
forall k1 k2.
(Pretty k1, Pretty k2, Ord k1, Ord k2) =&gt;
Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#memo"><span class="hs-identifier hs-var">memo</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397625"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397626"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-140"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Type (Ref k2 Type))
</span><a href=".."><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SubTypeM k1 k2 ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; SubTypeM k1 k2 ()) -&gt; String -&gt; SubTypeM k1 k2 ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; String) -&gt; Doc Any -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;Missing variant field&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; Doc Any -&gt; Doc Any
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href=".."><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href=".."><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679397627"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; Doc Any -&gt; Doc Any
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href=".."><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;of type&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; Doc Any -&gt; Doc Any
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href=".."><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type) -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href=".."><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397625"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-141"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397627"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679397627"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679397625"><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397625"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map FieldName (Type (Ref k1 Type)) -&gt; Fields (Ref k1 Type)
forall k a. Map k a -&gt; [(k, a)]
</span><a href=".."><span class="hs-identifier hs-var">M.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map FieldName (Type (Ref k1 Type))
</span><a href="#local-6989586621679397629"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-142"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- Reference types</span><span>
</span><span id="line-145"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#FuncT"><span class="hs-identifier hs-type">FuncT</span></a></span><span> </span><span id="local-6989586621679397623"><span class="annot"><span class="annottext">MethodType (Ref k1 Type)
</span><a href="#local-6989586621679397623"><span class="hs-identifier hs-var">mt1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#FuncT"><span class="hs-identifier hs-type">FuncT</span></a></span><span> </span><span id="local-6989586621679397622"><span class="annot"><span class="annottext">MethodType (Ref k2 Type)
</span><a href="#local-6989586621679397622"><span class="hs-identifier hs-var">mt2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MethodType (Ref k1 Type)
-&gt; MethodType (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
forall k2 k1.
(Pretty k2, Pretty k1, Ord k2, Ord k1) =&gt;
MethodType (Ref k1 Type)
-&gt; MethodType (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#goMethodType"><span class="hs-identifier hs-var">goMethodType</span></a></span><span> </span><span class="annot"><span class="annottext">MethodType (Ref k1 Type)
</span><a href="#local-6989586621679397623"><span class="hs-identifier hs-var">mt1</span></a></span><span> </span><span class="annot"><span class="annottext">MethodType (Ref k2 Type)
</span><a href="#local-6989586621679397622"><span class="hs-identifier hs-var">mt2</span></a></span><span>
</span><span id="line-146"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#ServiceT"><span class="hs-identifier hs-type">ServiceT</span></a></span><span> </span><span id="local-6989586621679397619"><span class="annot"><span class="annottext">[(Text, MethodType (Ref k1 Type))]
</span><a href="#local-6989586621679397619"><span class="hs-identifier hs-var">meths1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#ServiceT"><span class="hs-identifier hs-type">ServiceT</span></a></span><span> </span><span id="local-6989586621679397618"><span class="annot"><span class="annottext">[(Text, MethodType (Ref k2 Type))]
</span><a href="#local-6989586621679397618"><span class="hs-identifier hs-var">meths2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397617"><span class="annot"><span class="annottext">m1 :: Map Text (MethodType (Ref k1 Type))
</span><a href="#local-6989586621679397617"><span class="hs-identifier hs-var hs-var">m1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Text, MethodType (Ref k1 Type))]
-&gt; Map Text (MethodType (Ref k1 Type))
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href=".."><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, MethodType (Ref k1 Type))]
</span><a href="#local-6989586621679397619"><span class="hs-identifier hs-var">meths1</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><span class="annottext">[(Text, MethodType (Ref k2 Type))]
-&gt; ((Text, MethodType (Ref k2 Type)) -&gt; SubTypeM k1 k2 ())
-&gt; SubTypeM k1 k2 ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href=".."><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, MethodType (Ref k2 Type))]
</span><a href="#local-6989586621679397618"><span class="hs-identifier hs-var">meths2</span></a></span><span> </span><span class="annot"><span class="annottext">(((Text, MethodType (Ref k2 Type)) -&gt; SubTypeM k1 k2 ())
 -&gt; SubTypeM k1 k2 ())
-&gt; ((Text, MethodType (Ref k2 Type)) -&gt; SubTypeM k1 k2 ())
-&gt; SubTypeM k1 k2 ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679397615"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679397615"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679397614"><span class="annot"><span class="annottext">MethodType (Ref k2 Type)
</span><a href="#local-6989586621679397614"><span class="hs-identifier hs-var">mt2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Map Text (MethodType (Ref k1 Type))
-&gt; Maybe (MethodType (Ref k1 Type))
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href=".."><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679397615"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text (MethodType (Ref k1 Type))
</span><a href="#local-6989586621679397617"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679397613"><span class="annot"><span class="annottext">MethodType (Ref k1 Type)
</span><a href="#local-6989586621679397613"><span class="hs-identifier hs-var">mt1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MethodType (Ref k1 Type)
-&gt; MethodType (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
forall k2 k1.
(Pretty k2, Pretty k1, Ord k2, Ord k1) =&gt;
MethodType (Ref k1 Type)
-&gt; MethodType (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#goMethodType"><span class="hs-identifier hs-var">goMethodType</span></a></span><span> </span><span class="annot"><span class="annottext">MethodType (Ref k1 Type)
</span><a href="#local-6989586621679397613"><span class="hs-identifier hs-var">mt1</span></a></span><span> </span><span class="annot"><span class="annottext">MethodType (Ref k2 Type)
</span><a href="#local-6989586621679397614"><span class="hs-identifier hs-var">mt2</span></a></span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><span class="annottext">Maybe (MethodType (Ref k1 Type))
</span><a href=".."><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SubTypeM k1 k2 ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; SubTypeM k1 k2 ()) -&gt; String -&gt; SubTypeM k1 k2 ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; String) -&gt; Doc Any -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;Missing service method&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; Doc Any -&gt; Doc Any
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href=".."><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href=".."><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679397615"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; Doc Any -&gt; Doc Any
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href=".."><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;of type&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; Doc Any -&gt; Doc Any
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href=".."><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MethodType (Ref k2 Type) -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href=".."><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">MethodType (Ref k2 Type)
</span><a href="#local-6989586621679397614"><span class="hs-identifier hs-var">mt2</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- BlobT</span><span>
</span><span id="line-153"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#BlobT"><span class="hs-identifier hs-var">BlobT</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#BlobT"><span class="hs-identifier hs-var">BlobT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#VecT"><span class="hs-identifier hs-type">VecT</span></a></span><span> </span><span id="local-6989586621679397611"><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397611"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#BlobT"><span class="hs-identifier hs-var">BlobT</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type) -&gt; Bool
forall a. Type (Ref a Type) -&gt; Bool
</span><a href="Codec.Candid.Subtype.html#isNat8"><span class="hs-identifier hs-var">isNat8</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397611"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="Codec.Candid.Types.html#BlobT"><span class="hs-identifier hs-var">BlobT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#VecT"><span class="hs-identifier hs-type">VecT</span></a></span><span> </span><span id="local-6989586621679397609"><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397609"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type) -&gt; Bool
forall a. Type (Ref a Type) -&gt; Bool
</span><a href="Codec.Candid.Subtype.html#isNat8"><span class="hs-identifier hs-var">isNat8</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397609"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- Final catch-all</span><span>
</span><span id="line-158"></span><span class="annot"><a href="Codec.Candid.Subtype.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679397608"><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397608"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679397607"><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397607"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SubTypeM k1 k2 ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; SubTypeM k1 k2 ()) -&gt; String -&gt; SubTypeM k1 k2 ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; String) -&gt; Doc Any -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;Type&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; Doc Any -&gt; Doc Any
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href=".."><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type) -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href=".."><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397608"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; Doc Any -&gt; Doc Any
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href=".."><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;is not a subtype of&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; Doc Any -&gt; Doc Any
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href=".."><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type) -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href=".."><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397607"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span id="local-6989586621679397748"><span id="local-6989586621679397749"><span class="annot"><a href="Codec.Candid.Subtype.html#goMethodType"><span class="hs-identifier hs-type">goMethodType</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397749"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397748"><span class="hs-identifier hs-type">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397749"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397748"><span class="hs-identifier hs-type">k1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><a href="Codec.Candid.Types.html#MethodType"><span class="hs-identifier hs-type">MethodType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397748"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><a href="Codec.Candid.Types.html#MethodType"><span class="hs-identifier hs-type">MethodType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397749"><span class="hs-identifier hs-type">k2</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><a href="Codec.Candid.Subtype.html#SubTypeM"><span class="hs-identifier hs-type">SubTypeM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397748"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397749"><span class="hs-identifier hs-type">k2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-165"></span><span id="goMethodType"><span class="annot"><span class="annottext">goMethodType :: MethodType (Ref k1 Type)
-&gt; MethodType (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#goMethodType"><span class="hs-identifier hs-var hs-var">goMethodType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#MethodType"><span class="hs-identifier hs-type">MethodType</span></a></span><span> </span><span id="local-6989586621679397605"><span class="annot"><span class="annottext">[Type (Ref k1 Type)]
</span><a href="#local-6989586621679397605"><span class="hs-identifier hs-var">ta1</span></a></span></span><span> </span><span id="local-6989586621679397604"><span class="annot"><span class="annottext">[Type (Ref k1 Type)]
</span><a href="#local-6989586621679397604"><span class="hs-identifier hs-var">tr1</span></a></span></span><span> </span><span id="local-6989586621679397603"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679397603"><span class="hs-identifier hs-var">q1</span></a></span></span><span> </span><span id="local-6989586621679397602"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679397602"><span class="hs-identifier hs-var">o1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#MethodType"><span class="hs-identifier hs-type">MethodType</span></a></span><span> </span><span id="local-6989586621679397601"><span class="annot"><span class="annottext">[Type (Ref k2 Type)]
</span><a href="#local-6989586621679397601"><span class="hs-identifier hs-var">ta2</span></a></span></span><span> </span><span id="local-6989586621679397600"><span class="annot"><span class="annottext">[Type (Ref k2 Type)]
</span><a href="#local-6989586621679397600"><span class="hs-identifier hs-var">tr2</span></a></span></span><span> </span><span id="local-6989586621679397599"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679397599"><span class="hs-identifier hs-var">q2</span></a></span></span><span> </span><span id="local-6989586621679397598"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679397598"><span class="hs-identifier hs-var">o2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; SubTypeM k1 k2 () -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679397603"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679397599"><span class="hs-identifier hs-var">q2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SubTypeM k1 k2 () -&gt; SubTypeM k1 k2 ())
-&gt; SubTypeM k1 k2 () -&gt; SubTypeM k1 k2 ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SubTypeM k1 k2 ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Methods differ in query annotation&quot;</span></span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; SubTypeM k1 k2 () -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679397602"><span class="hs-identifier hs-var">o1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679397598"><span class="hs-identifier hs-var">o2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SubTypeM k1 k2 () -&gt; SubTypeM k1 k2 ())
-&gt; SubTypeM k1 k2 () -&gt; SubTypeM k1 k2 ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SubTypeM k1 k2 ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Methods differ in oneway annotation&quot;</span></span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="annottext">SubTypeM k2 k1 () -&gt; SubTypeM k1 k2 ()
forall k1 k2 a. SubTypeM k1 k2 a -&gt; SubTypeM k2 k1 a
</span><a href="Codec.Candid.Subtype.html#flipM"><span class="hs-identifier hs-var">flipM</span></a></span><span> </span><span class="annot"><span class="annottext">(SubTypeM k2 k1 () -&gt; SubTypeM k1 k2 ())
-&gt; SubTypeM k2 k1 () -&gt; SubTypeM k1 k2 ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k2 Type)] -&gt; [Type (Ref k1 Type)] -&gt; SubTypeM k2 k1 ()
forall k1 k2.
(Pretty k1, Pretty k2, Ord k1, Ord k2) =&gt;
[Type (Ref k1 Type)] -&gt; [Type (Ref k2 Type)] -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#goSeq"><span class="hs-identifier hs-var">goSeq</span></a></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k2 Type)]
</span><a href="#local-6989586621679397601"><span class="hs-identifier hs-var">ta2</span></a></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k1 Type)]
</span><a href="#local-6989586621679397605"><span class="hs-identifier hs-var">ta1</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="annottext">[Type (Ref k1 Type)] -&gt; [Type (Ref k2 Type)] -&gt; SubTypeM k1 k2 ()
forall k1 k2.
(Pretty k1, Pretty k2, Ord k1, Ord k2) =&gt;
[Type (Ref k1 Type)] -&gt; [Type (Ref k2 Type)] -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#goSeq"><span class="hs-identifier hs-var">goSeq</span></a></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k1 Type)]
</span><a href="#local-6989586621679397604"><span class="hs-identifier hs-var">tr1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k2 Type)]
</span><a href="#local-6989586621679397600"><span class="hs-identifier hs-var">tr2</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span id="goSeq"><span class="annot"><span class="annottext">goSeq :: [Type (Ref k1 Type)] -&gt; [Type (Ref k2 Type)] -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#goSeq"><span class="hs-identifier hs-var hs-var">goSeq</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k1 Type)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; SubTypeM k1 k2 ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span class="annot"><a href="Codec.Candid.Subtype.html#goSeq"><span class="hs-identifier hs-var">goSeq</span></a></span><span> </span><span id="local-6989586621679397596"><span class="annot"><span class="annottext">[Type (Ref k1 Type)]
</span><a href="#local-6989586621679397596"><span class="hs-identifier hs-var">ts1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#RefT"><span class="hs-identifier hs-type">RefT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><span class="annottext">k2
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679397595"><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397595"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href=".."><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679397594"><span class="annot"><span class="annottext">[Type (Ref k2 Type)]
</span><a href="#local-6989586621679397594"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type (Ref k1 Type)] -&gt; [Type (Ref k2 Type)] -&gt; SubTypeM k1 k2 ()
forall k1 k2.
(Pretty k1, Pretty k2, Ord k1, Ord k2) =&gt;
[Type (Ref k1 Type)] -&gt; [Type (Ref k2 Type)] -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#goSeq"><span class="hs-identifier hs-var">goSeq</span></a></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k1 Type)]
</span><a href="#local-6989586621679397596"><span class="hs-identifier hs-var">ts1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397595"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Type (Ref k2 Type) -&gt; [Type (Ref k2 Type)] -&gt; [Type (Ref k2 Type)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Type (Ref k2 Type)]
</span><a href="#local-6989586621679397594"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- Missing optional arguments are ok</span><span>
</span><span id="line-174"></span><span class="annot"><a href="Codec.Candid.Subtype.html#goSeq"><span class="hs-identifier hs-var">goSeq</span></a></span><span> </span><span id="local-6989586621679397593"><span class="annot"><span class="annottext">ts1 :: [Type (Ref k1 Type)]
</span><a href="#local-6989586621679397593"><span class="hs-identifier hs-var">ts1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#OptT"><span class="hs-identifier hs-type">OptT</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href=".."><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679397592"><span class="annot"><span class="annottext">[Type (Ref k2 Type)]
</span><a href="#local-6989586621679397592"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type (Ref k1 Type)] -&gt; [Type (Ref k2 Type)] -&gt; SubTypeM k1 k2 ()
forall k1 k2.
(Pretty k1, Pretty k2, Ord k1, Ord k2) =&gt;
[Type (Ref k1 Type)] -&gt; [Type (Ref k2 Type)] -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#goSeq"><span class="hs-identifier hs-var">goSeq</span></a></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k1 Type)]
</span><a href="#local-6989586621679397593"><span class="hs-identifier hs-var">ts1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k2 Type)]
</span><a href="#local-6989586621679397592"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-175"></span><span class="annot"><a href="Codec.Candid.Subtype.html#goSeq"><span class="hs-identifier hs-var">goSeq</span></a></span><span> </span><span id="local-6989586621679397591"><span class="annot"><span class="annottext">ts1 :: [Type (Ref k1 Type)]
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">ts1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="Codec.Candid.Types.html#ReservedT"><span class="hs-identifier hs-var">ReservedT</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679397590"><span class="annot"><span class="annottext">[Type (Ref k2 Type)]
</span><a href="#local-6989586621679397590"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type (Ref k1 Type)] -&gt; [Type (Ref k2 Type)] -&gt; SubTypeM k1 k2 ()
forall k1 k2.
(Pretty k1, Pretty k2, Ord k1, Ord k2) =&gt;
[Type (Ref k1 Type)] -&gt; [Type (Ref k2 Type)] -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#goSeq"><span class="hs-identifier hs-var">goSeq</span></a></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k1 Type)]
</span><a href="#local-6989586621679397591"><span class="hs-identifier hs-var">ts1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k2 Type)]
</span><a href="#local-6989586621679397590"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Codec.Candid.Subtype.html#goSeq"><span class="hs-identifier hs-var">goSeq</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679397589"><span class="annot"><span class="annottext">[Type (Ref k2 Type)]
</span><a href="#local-6989586621679397589"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SubTypeM k1 k2 ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; SubTypeM k1 k2 ()) -&gt; String -&gt; SubTypeM k1 k2 ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; String) -&gt; Doc Any -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;Argument type list too short, expecting types&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; Doc Any -&gt; Doc Any
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href=".."><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k2 Type)] -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href=".."><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k2 Type)]
</span><a href="#local-6989586621679397589"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-177"></span><span class="annot"><a href="Codec.Candid.Subtype.html#goSeq"><span class="hs-identifier hs-var">goSeq</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397588"><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397588"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="annot"><a href=".."><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679397587"><span class="annot"><span class="annottext">[Type (Ref k1 Type)]
</span><a href="#local-6989586621679397587"><span class="hs-identifier hs-var">ts1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397586"><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397586"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="annot"><a href=".."><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679397585"><span class="annot"><span class="annottext">[Type (Ref k2 Type)]
</span><a href="#local-6989586621679397585"><span class="hs-identifier hs-var">ts2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
forall k1 k2.
(Pretty k1, Pretty k2, Ord k1, Ord k2) =&gt;
Type (Ref k1 Type) -&gt; Type (Ref k2 Type) -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#memo"><span class="hs-identifier hs-var">memo</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k1 Type)
</span><a href="#local-6989586621679397588"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref k2 Type)
</span><a href="#local-6989586621679397586"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">SubTypeM k1 k2 () -&gt; SubTypeM k1 k2 () -&gt; SubTypeM k1 k2 ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k1 Type)] -&gt; [Type (Ref k2 Type)] -&gt; SubTypeM k1 k2 ()
forall k1 k2.
(Pretty k1, Pretty k2, Ord k1, Ord k2) =&gt;
[Type (Ref k1 Type)] -&gt; [Type (Ref k2 Type)] -&gt; SubTypeM k1 k2 ()
</span><a href="Codec.Candid.Subtype.html#goSeq"><span class="hs-identifier hs-var">goSeq</span></a></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k1 Type)]
</span><a href="#local-6989586621679397587"><span class="hs-identifier hs-var">ts1</span></a></span><span> </span><span class="annot"><span class="annottext">[Type (Ref k2 Type)]
</span><a href="#local-6989586621679397585"><span class="hs-identifier hs-var">ts2</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span id="local-6989586621679397767"><span class="annot"><a href="Codec.Candid.Subtype.html#unRef"><span class="hs-identifier hs-type">unRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397767"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397767"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-180"></span><span id="unRef"><span class="annot"><span class="annottext">unRef :: Type (Ref a Type) -&gt; Type (Ref a Type)
</span><a href="Codec.Candid.Subtype.html#unRef"><span class="hs-identifier hs-var hs-var">unRef</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#RefT"><span class="hs-identifier hs-type">RefT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679397584"><span class="annot"><span class="annottext">Type (Ref a Type)
</span><a href="#local-6989586621679397584"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type (Ref a Type) -&gt; Type (Ref a Type)
forall a. Type (Ref a Type) -&gt; Type (Ref a Type)
</span><a href="Codec.Candid.Subtype.html#unRef"><span class="hs-identifier hs-var">unRef</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref a Type)
</span><a href="#local-6989586621679397584"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-181"></span><span class="annot"><a href="Codec.Candid.Subtype.html#unRef"><span class="hs-identifier hs-var">unRef</span></a></span><span> </span><span id="local-6989586621679397583"><span class="annot"><span class="annottext">Type (Ref a Type)
</span><a href="#local-6989586621679397583"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type (Ref a Type)
</span><a href="#local-6989586621679397583"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span id="local-6989586621679397742"><span class="annot"><a href="Codec.Candid.Subtype.html#isNat8"><span class="hs-identifier hs-type">isNat8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397742"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-184"></span><span id="isNat8"><span class="annot"><span class="annottext">isNat8 :: Type (Ref a Type) -&gt; Bool
</span><a href="Codec.Candid.Subtype.html#isNat8"><span class="hs-identifier hs-var hs-var">isNat8</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#RefT"><span class="hs-identifier hs-type">RefT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679397582"><span class="annot"><span class="annottext">Type (Ref a Type)
</span><a href="#local-6989586621679397582"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type (Ref a Type) -&gt; Bool
forall a. Type (Ref a Type) -&gt; Bool
</span><a href="Codec.Candid.Subtype.html#isNat8"><span class="hs-identifier hs-var">isNat8</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref a Type)
</span><a href="#local-6989586621679397582"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-185"></span><span class="annot"><a href="Codec.Candid.Subtype.html#isNat8"><span class="hs-identifier hs-var">isNat8</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref a Type)
</span><a href="Codec.Candid.Types.html#Nat8T"><span class="hs-identifier hs-var">Nat8T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Codec.Candid.Subtype.html#isNat8"><span class="hs-identifier hs-var">isNat8</span></a></span><span> </span><span class="annot"><span class="annottext">Type (Ref a Type)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-187"></span></pre></body></html>