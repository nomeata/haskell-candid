<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Codec.Candid.TH</span><span>
</span><span id="line-7"></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Codec.Candid.TH.html#candid"><span class="hs-identifier">candid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.TH.html#candidFile"><span class="hs-identifier">candidFile</span></a></span><span>
</span><span id="line-8"></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.TH.html#candidType"><span class="hs-identifier">candidType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.TH.html#candidTypeQ"><span class="hs-identifier">candidTypeQ</span></a></span><span>
</span><span id="line-9"></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.TH.html#candidDefs"><span class="hs-identifier">candidDefs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.TH.html#candidDefsFile"><span class="hs-identifier">candidDefsFile</span></a></span><span>
</span><span id="line-10"></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.TH.html#generateCandidDefs"><span class="hs-identifier">generateCandidDefs</span></a></span><span>
</span><span id="line-11"></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Row.Records</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">R</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Row.Variants</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Vector</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Numeric.Natural</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Int</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Void</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Foldable</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Traversable</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.List</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier">stronglyConnComp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">SCC</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Language.Haskell.TH.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TH</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Language.Haskell.TH.Quote</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Language.Haskell.TH.Lib</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Language.Haskell.TH.Syntax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier">Q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">lookupTypeName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">newName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Dec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">mkName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Candid.Parse.html"><span class="hs-identifier">Codec.Candid.Parse</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Candid.Data.html"><span class="hs-identifier">Codec.Candid.Data</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Candid.Tuples.html"><span class="hs-identifier">Codec.Candid.Tuples</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html"><span class="hs-identifier">Codec.Candid.Types</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Candid.FieldName.html"><span class="hs-identifier">Codec.Candid.FieldName</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Candid.Class.html"><span class="hs-identifier">Codec.Candid.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Class.html#Candid"><span class="hs-identifier">Candid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.Class.html#AnnTrue"><span class="hs-identifier">AnnTrue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.Class.html#AnnFalse"><span class="hs-identifier">AnnFalse</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | This quasi-quoter turns a Candid service description into a Haskell type. It assumes a type variable @m@ to be in scope, and uses that as the monad for the service's methods.</span><span>
</span><span id="line-42"></span><span class="hs-comment">--</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- Recursive types are not supported.</span><span>
</span><span id="line-44"></span><span class="annot"><a href="Codec.Candid.TH.html#candid"><span class="hs-identifier hs-type">candid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">QuasiQuoter</span></a></span><span>
</span><span id="line-45"></span><span id="candid"><span class="annot"><span class="annottext">candid :: QuasiQuoter
</span><a href="Codec.Candid.TH.html#candid"><span class="hs-identifier hs-var hs-var">candid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuasiQuoter :: (String -&gt; Q Exp)
-&gt; (String -&gt; Q Pat)
-&gt; (String -&gt; Q Type)
-&gt; (String -&gt; Q [Dec])
-&gt; QuasiQuoter
</span><a href=".."><span class="hs-identifier hs-type">QuasiQuoter</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">quoteExp :: String -&gt; Q Exp
</span><a href=".."><span class="hs-identifier hs-var">quoteExp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Exp
forall (m :: * -&gt; *) p a. MonadFail m =&gt; p -&gt; m a
</span><a href="#local-6989586621679405890"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">quotePat :: String -&gt; Q Pat
</span><a href=".."><span class="hs-identifier hs-var">quotePat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Pat
forall (m :: * -&gt; *) p a. MonadFail m =&gt; p -&gt; m a
</span><a href="#local-6989586621679405890"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">quoteDec :: String -&gt; Q [Dec]
</span><a href=".."><span class="hs-identifier hs-var">quoteDec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q [Dec]
forall (m :: * -&gt; *) p a. MonadFail m =&gt; p -&gt; m a
</span><a href="#local-6989586621679405890"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">quoteType :: String -&gt; Q Type
</span><a href=".."><span class="hs-identifier hs-var">quoteType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Type
</span><a href="Codec.Candid.TH.html#quoteCandidService"><span class="hs-identifier hs-var">quoteCandidService</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679405890"><span class="annot"><span class="annottext">err :: p -&gt; m a
</span><a href="#local-6989586621679405890"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; m a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[candid| &#8230; |] can only be used as a type&quot;</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- | As 'candid', but takes a filename</span><span>
</span><span id="line-49"></span><span class="annot"><a href="Codec.Candid.TH.html#candidFile"><span class="hs-identifier hs-type">candidFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">QuasiQuoter</span></a></span><span>
</span><span id="line-50"></span><span id="candidFile"><span class="annot"><span class="annottext">candidFile :: QuasiQuoter
</span><a href="Codec.Candid.TH.html#candidFile"><span class="hs-identifier hs-var hs-var">candidFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuasiQuoter -&gt; QuasiQuoter
</span><a href=".."><span class="hs-identifier hs-var">quoteFile</span></a></span><span> </span><span class="annot"><span class="annottext">QuasiQuoter
</span><a href="Codec.Candid.TH.html#candid"><span class="hs-identifier hs-var">candid</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">-- | This quasi-quoter turns all type definitions of a Canddi file into Haskell types, as one 'Row'. The @service@ of the candid file is ignored.</span><span>
</span><span id="line-53"></span><span class="hs-comment">--</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- Recursive types are not supported.</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- </span><span>
</span><span id="line-56"></span><span class="hs-comment">-- This quasi-quoter works differently depending on context:</span><span>
</span><span id="line-57"></span><span class="hs-comment">--</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- As a _type_, it expands to a row-types record with one entry per type</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- defined in the Candid file:</span><span>
</span><span id="line-60"></span><span class="hs-comment">--</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- &gt; type MyDefs = [candidDefs|type t = text; ... |]</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- &gt; foo :: MyDefs .! &quot;t&quot;</span><span>
</span><span id="line-64"></span><span class="hs-comment">--</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- As a _declaration_ (i.e. the module top level), it generates one type</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- synonym (@type Foo = ...@) per definition. This only works if the candid</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- type name is a valid Haskell type name (in particular, upper case). This may</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- improve in the future.</span><span>
</span><span id="line-69"></span><span class="hs-comment">--</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- &gt; [candidDefs|type Foo = text; ... |]</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- &gt; foo :: Foo</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- You can use `-ddump-splices` to see the generated code.</span><span>
</span><span id="line-75"></span><span class="annot"><a href="Codec.Candid.TH.html#candidDefs"><span class="hs-identifier hs-type">candidDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">QuasiQuoter</span></a></span><span>
</span><span id="line-76"></span><span id="candidDefs"><span class="annot"><span class="annottext">candidDefs :: QuasiQuoter
</span><a href="Codec.Candid.TH.html#candidDefs"><span class="hs-identifier hs-var hs-var">candidDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuasiQuoter :: (String -&gt; Q Exp)
-&gt; (String -&gt; Q Pat)
-&gt; (String -&gt; Q Type)
-&gt; (String -&gt; Q [Dec])
-&gt; QuasiQuoter
</span><a href=".."><span class="hs-identifier hs-type">QuasiQuoter</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">quoteExp :: String -&gt; Q Exp
</span><a href=".."><span class="hs-identifier hs-var">quoteExp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Exp
forall (m :: * -&gt; *) p a. MonadFail m =&gt; p -&gt; m a
</span><a href="#local-6989586621679405887"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">quotePat :: String -&gt; Q Pat
</span><a href=".."><span class="hs-identifier hs-var">quotePat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Pat
forall (m :: * -&gt; *) p a. MonadFail m =&gt; p -&gt; m a
</span><a href="#local-6989586621679405887"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">quoteDec :: String -&gt; Q [Dec]
</span><a href=".."><span class="hs-identifier hs-var">quoteDec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q [Dec]
</span><a href="Codec.Candid.TH.html#quoteCandidDefsSym"><span class="hs-identifier hs-var">quoteCandidDefsSym</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">quoteType :: String -&gt; Q Type
</span><a href=".."><span class="hs-identifier hs-var">quoteType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Type
</span><a href="Codec.Candid.TH.html#quoteCandidDefs"><span class="hs-identifier hs-var">quoteCandidDefs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679405887"><span class="annot"><span class="annottext">err :: p -&gt; m a
</span><a href="#local-6989586621679405887"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; m a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[candidDefs| &#8230; |] can only be used as a type or as declarations&quot;</span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | As 'candid', but takes a filename</span><span>
</span><span id="line-80"></span><span class="annot"><a href="Codec.Candid.TH.html#candidDefsFile"><span class="hs-identifier hs-type">candidDefsFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">QuasiQuoter</span></a></span><span>
</span><span id="line-81"></span><span id="candidDefsFile"><span class="annot"><span class="annottext">candidDefsFile :: QuasiQuoter
</span><a href="Codec.Candid.TH.html#candidDefsFile"><span class="hs-identifier hs-var hs-var">candidDefsFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuasiQuoter -&gt; QuasiQuoter
</span><a href=".."><span class="hs-identifier hs-var">quoteFile</span></a></span><span> </span><span class="annot"><span class="annottext">QuasiQuoter
</span><a href="Codec.Candid.TH.html#candidDefs"><span class="hs-identifier hs-var">candidDefs</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- | This quasi-quoter turns works on individual candid types, e.g.</span><span>
</span><span id="line-84"></span><span class="hs-comment">--</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- &gt; type InstallMode = [candidType| variant {install : null; reinstall : null; upgrade : null}; |]</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Codec.Candid.TH.html#candidType"><span class="hs-identifier hs-type">candidType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">QuasiQuoter</span></a></span><span>
</span><span id="line-87"></span><span id="candidType"><span class="annot"><span class="annottext">candidType :: QuasiQuoter
</span><a href="Codec.Candid.TH.html#candidType"><span class="hs-identifier hs-var hs-var">candidType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuasiQuoter :: (String -&gt; Q Exp)
-&gt; (String -&gt; Q Pat)
-&gt; (String -&gt; Q Type)
-&gt; (String -&gt; Q [Dec])
-&gt; QuasiQuoter
</span><a href=".."><span class="hs-identifier hs-type">QuasiQuoter</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">quoteExp :: String -&gt; Q Exp
</span><a href=".."><span class="hs-identifier hs-var">quoteExp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Exp
forall (m :: * -&gt; *) p a. MonadFail m =&gt; p -&gt; m a
</span><a href="#local-6989586621679405884"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">quotePat :: String -&gt; Q Pat
</span><a href=".."><span class="hs-identifier hs-var">quotePat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Pat
forall (m :: * -&gt; *) p a. MonadFail m =&gt; p -&gt; m a
</span><a href="#local-6989586621679405884"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">quoteDec :: String -&gt; Q [Dec]
</span><a href=".."><span class="hs-identifier hs-var">quoteDec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q [Dec]
forall (m :: * -&gt; *) p a. MonadFail m =&gt; p -&gt; m a
</span><a href="#local-6989586621679405884"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">quoteType :: String -&gt; Q Type
</span><a href=".."><span class="hs-identifier hs-var">quoteType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Type
</span><a href="Codec.Candid.TH.html#quoteCandidType"><span class="hs-identifier hs-var">quoteCandidType</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679405884"><span class="annot"><span class="annottext">err :: p -&gt; m a
</span><a href="#local-6989586621679405884"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; m a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[candidType| &#8230; |] can only be used as a type&quot;</span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- | Turns all candid type definitions into newtypes</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- Used, so far, only in the Candid test suite runner</span><span>
</span><span id="line-92"></span><span class="annot"><a href="Codec.Candid.TH.html#generateCandidDefs"><span class="hs-identifier hs-type">generateCandidDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">T.Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Candid.Types.html#DidDef"><span class="hs-identifier hs-type">DidDef</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Dec</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TH.Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span id="generateCandidDefs"><span class="annot"><span class="annottext">generateCandidDefs :: Text -&gt; [DidDef Text] -&gt; Q ([Dec], Text -&gt; Q Name)
</span><a href="Codec.Candid.TH.html#generateCandidDefs"><span class="hs-identifier hs-var hs-var">generateCandidDefs</span></a></span></span><span> </span><span id="local-6989586621679405881"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405881"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span id="local-6989586621679405880"><span class="annot"><span class="annottext">[DidDef Text]
</span><a href="#local-6989586621679405880"><span class="hs-identifier hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621679405879"><span class="annot"><span class="annottext">[(Text, Name)]
</span><a href="#local-6989586621679405879"><span class="hs-identifier hs-var">assocs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[DidDef Text]
-&gt; (DidDef Text -&gt; Q (Text, Name)) -&gt; Q [(Text, Name)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><a href=".."><span class="hs-identifier hs-var">for</span></a></span><span> </span><span class="annot"><span class="annottext">[DidDef Text]
</span><a href="#local-6989586621679405880"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">((DidDef Text -&gt; Q (Text, Name)) -&gt; Q [(Text, Name)])
-&gt; (DidDef Text -&gt; Q (Text, Name)) -&gt; Q [(Text, Name)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679405877"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405877"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-95"></span><span>        </span><span id="local-6989586621679405876"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679405876"><span class="hs-identifier hs-var">thn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
</span><a href=".."><span class="hs-identifier hs-var">newName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Candid_&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405881"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405877"><span class="hs-identifier hs-var">tn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>        </span><span class="annot"><span class="annottext">(Text, Name) -&gt; Q (Text, Name)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405877"><span class="hs-identifier hs-var">tn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679405876"><span class="hs-identifier hs-var">thn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679405874"><span class="annot"><span class="annottext">m :: Map Text Name
</span><a href="#local-6989586621679405874"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Text, Name)] -&gt; Map Text Name
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href=".."><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Name)]
</span><a href="#local-6989586621679405879"><span class="hs-identifier hs-var">assocs</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679405872"><span class="annot"><span class="annottext">resolve :: Text -&gt; m Name
</span><a href="#local-6989586621679405872"><span class="hs-identifier hs-var hs-var">resolve</span></a></span></span><span> </span><span id="local-6989586621679405871"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405871"><span class="hs-identifier hs-var">tn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Map Text Name -&gt; Maybe Name
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href=".."><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405871"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text Name
</span><a href="#local-6989586621679405874"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-100"></span><span>            </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679405869"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679405869"><span class="hs-identifier hs-var">thn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; m Name
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679405869"><span class="hs-identifier hs-var">thn</span></a></span><span>
</span><span id="line-101"></span><span>            </span><span class="annot"><span class="annottext">Maybe Name
</span><a href=".."><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; m Name
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m Name) -&gt; String -&gt; m Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Could not find type &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405871"><span class="hs-identifier hs-var">tn</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679405868"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679405868"><span class="hs-identifier hs-var">decls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[DidDef Text] -&gt; (DidDef Text -&gt; Q Dec) -&gt; Q [Dec]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><a href=".."><span class="hs-identifier hs-var">for</span></a></span><span> </span><span class="annot"><span class="annottext">[DidDef Text]
</span><a href="#local-6989586621679405880"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">((DidDef Text -&gt; Q Dec) -&gt; Q [Dec])
-&gt; (DidDef Text -&gt; Q Dec) -&gt; Q [Dec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679405867"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405867"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679405866"><span class="annot"><span class="annottext">Type Text
</span><a href="#local-6989586621679405866"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-103"></span><span>          </span><span id="local-6989586621679405865"><span class="annot"><span class="annottext">Type Name
</span><a href="#local-6989586621679405865"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Q Name) -&gt; Type Text -&gt; Q (Type Name)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href=".."><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Q Name
forall (m :: * -&gt; *). MonadFail m =&gt; Text -&gt; m Name
</span><a href="#local-6989586621679405872"><span class="hs-identifier hs-var">resolve</span></a></span><span> </span><span class="annot"><span class="annottext">Type Text
</span><a href="#local-6989586621679405866"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-104"></span><span>          </span><span id="local-6989586621679405863"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679405863"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Q Name
forall (m :: * -&gt; *). MonadFail m =&gt; Text -&gt; m Name
</span><a href="#local-6989586621679405872"><span class="hs-identifier hs-var">resolve</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405867"><span class="hs-identifier hs-var">tn</span></a></span><span>
</span><span id="line-105"></span><span>          </span><span id="local-6989586621679405862"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679405862"><span class="hs-identifier hs-var">dn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
</span><a href=".."><span class="hs-identifier hs-var">newName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Candid_&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405881"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405867"><span class="hs-identifier hs-var">tn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>          </span><span class="annot"><span class="annottext">CxtQ
-&gt; Name
-&gt; [TyVarBndr]
-&gt; Maybe Type
-&gt; ConQ
-&gt; [DerivClauseQ]
-&gt; Q Dec
</span><a href=".."><span class="hs-identifier hs-var">newtypeD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Q Type] -&gt; CxtQ
</span><a href=".."><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679405863"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><a href=".."><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-107"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [BangTypeQ] -&gt; ConQ
</span><a href=".."><span class="hs-identifier hs-var">normalC</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679405862"><span class="hs-identifier hs-var">dn</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BangQ -&gt; Q Type -&gt; BangTypeQ
</span><a href=".."><span class="hs-identifier hs-var">bangType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceUnpackednessQ -&gt; SourceStrictnessQ -&gt; BangQ
</span><a href=".."><span class="hs-identifier hs-var">bang</span></a></span><span> </span><span class="annot"><span class="annottext">SourceUnpackednessQ
</span><a href=".."><span class="hs-identifier hs-var">noSourceUnpackedness</span></a></span><span> </span><span class="annot"><span class="annottext">SourceStrictnessQ
</span><a href=".."><span class="hs-identifier hs-var">noSourceStrictness</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type Name -&gt; Q Type
</span><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="#local-6989586621679405865"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>            </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe DerivStrategy -&gt; [Q Type] -&gt; DerivClauseQ
</span><a href=".."><span class="hs-identifier hs-var">derivClause</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DerivStrategy
forall a. Maybe a
</span><a href=".."><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Q Type
</span><a href=".."><span class="hs-identifier hs-var">conT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Candid</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
</span><a href=".."><span class="hs-identifier hs-var">conT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Eq</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
</span><a href=".."><span class="hs-identifier hs-var">conT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Show</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">([Dec], Text -&gt; Q Name) -&gt; Q ([Dec], Text -&gt; Q Name)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679405868"><span class="hs-identifier hs-var">decls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Q Name
forall (m :: * -&gt; *). MonadFail m =&gt; Text -&gt; m Name
</span><a href="#local-6989586621679405872"><span class="hs-identifier hs-var">resolve</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- | Inlines all candid type definitions, after checking for loops</span><span>
</span><span id="line-112"></span><span class="annot"><a href="Codec.Candid.TH.html#inlineDefs"><span class="hs-identifier hs-type">inlineDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679405945"><span class="annot"><a href="#local-6989586621679405945"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-operator">.</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679405945"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679405945"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Candid.Types.html#DidDef"><span class="hs-identifier hs-type">DidDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679405945"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679405945"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Void</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679405945"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679405945"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Void</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span id="inlineDefs"><span class="annot"><span class="annottext">inlineDefs :: [DidDef k] -&gt; Q ([(k, Type Void)], k -&gt; Q (), k -&gt; Type Void)
</span><a href="Codec.Candid.TH.html#inlineDefs"><span class="hs-identifier hs-var hs-var">inlineDefs</span></a></span></span><span> </span><span id="local-6989586621679405857"><span class="annot"><span class="annottext">[DidDef k]
</span><a href="#local-6989586621679405857"><span class="hs-identifier hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">[[k]] -&gt; ([k] -&gt; Q Any) -&gt; Q ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">for_</span></a></span><span> </span><span class="annot"><span class="annottext">[[k]]
</span><a href="#local-6989586621679405855"><span class="hs-identifier hs-var">sccs</span></a></span><span> </span><span class="annot"><span class="annottext">(([k] -&gt; Q Any) -&gt; Q ()) -&gt; ([k] -&gt; Q Any) -&gt; Q ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679405854"><span class="annot"><span class="annottext">[k]
</span><a href="#local-6989586621679405854"><span class="hs-identifier hs-var">scc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Q Any
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Q Any) -&gt; String -&gt; Q Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cyclic type definitions not supported: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><a href=".."><span class="hs-identifier hs-var">intercalate</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; String) -&gt; [k] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href=".."><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[k]
</span><a href="#local-6989586621679405854"><span class="hs-identifier hs-var">scc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="annottext">[DidDef k] -&gt; (DidDef k -&gt; Q ()) -&gt; Q ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">for_</span></a></span><span> </span><span class="annot"><span class="annottext">[DidDef k]
</span><a href="#local-6989586621679405857"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">((DidDef k -&gt; Q ()) -&gt; Q ()) -&gt; (DidDef k -&gt; Q ()) -&gt; Q ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679405851"><span class="annot"><span class="annottext">Type k
</span><a href="#local-6989586621679405851"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type k -&gt; (k -&gt; Q ()) -&gt; Q ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">for_</span></a></span><span> </span><span class="annot"><span class="annottext">Type k
</span><a href="#local-6989586621679405851"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; Q ()
forall (f :: * -&gt; *). MonadFail f =&gt; k -&gt; f ()
</span><a href="#local-6989586621679405850"><span class="hs-identifier hs-var">checkKey</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><span class="annottext">([(k, Type Void)], k -&gt; Q (), k -&gt; Type Void)
-&gt; Q ([(k, Type Void)], k -&gt; Q (), k -&gt; Type Void)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k (Type Void) -&gt; [(k, Type Void)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href=".."><span class="hs-identifier hs-var">M.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map k (Type Void)
</span><a href="#local-6989586621679405848"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">k -&gt; Q ()
forall (f :: * -&gt; *). MonadFail f =&gt; k -&gt; f ()
</span><a href="#local-6989586621679405850"><span class="hs-identifier hs-var">checkKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">k -&gt; Type Void
</span><a href="#local-6989586621679405847"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679405855"><span class="annot"><span class="annottext">sccs :: [[k]]
</span><a href="#local-6989586621679405855"><span class="hs-identifier hs-var hs-var">sccs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[k]
</span><a href="#local-6989586621679405846"><span class="hs-identifier hs-var">tns</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">CyclicSCC</span></a></span><span> </span><span id="local-6989586621679405846"><span class="annot"><span class="annottext">[k]
</span><a href="#local-6989586621679405846"><span class="hs-identifier hs-var">tns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><span class="annottext">[(k, k, [k])] -&gt; [SCC k]
forall key node. Ord key =&gt; [(node, key, [key])] -&gt; [SCC node]
</span><a href=".."><span class="hs-identifier hs-var">stronglyConnComp</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679405844"><span class="hs-identifier hs-var">tn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679405844"><span class="hs-identifier hs-var">tn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type k -&gt; [k]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href=".."><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">Type k
</span><a href="#local-6989586621679405842"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679405844"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679405844"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679405842"><span class="annot"><span class="annottext">Type k
</span><a href="#local-6989586621679405842"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[DidDef k]
</span><a href="#local-6989586621679405857"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="#local-6989586621679405847"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679405945"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Void</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span id="local-6989586621679405847"><span class="annot"><span class="annottext">f :: k -&gt; Type Void
</span><a href="#local-6989586621679405847"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679405841"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679405841"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k (Type Void)
</span><a href="#local-6989586621679405848"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Map k (Type Void) -&gt; k -&gt; Type Void
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href=".."><span class="hs-operator hs-var">M.!</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679405841"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><a href="#local-6989586621679405848"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679405945"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Void</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621679405848"><span class="annot"><span class="annottext">m :: Map k (Type Void)
</span><a href="#local-6989586621679405848"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type k -&gt; (k -&gt; Type Void) -&gt; Type Void
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; Type Void
</span><a href="#local-6989586621679405847"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type k -&gt; Type Void) -&gt; Map k (Type k) -&gt; Map k (Type Void)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[DidDef k] -&gt; Map k (Type k)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href=".."><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[DidDef k]
</span><a href="#local-6989586621679405857"><span class="hs-identifier hs-var">defs</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621679405850"><span class="annot"><span class="annottext">checkKey :: k -&gt; f ()
</span><a href="#local-6989586621679405850"><span class="hs-identifier hs-var hs-var">checkKey</span></a></span></span><span> </span><span id="local-6989586621679405838"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679405838"><span class="hs-identifier hs-var">tn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; f () -&gt; f ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679405838"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k (Type Void) -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">`M.member`</span></a></span><span> </span><span class="annot"><span class="annottext">Map k (Type Void)
</span><a href="#local-6989586621679405848"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(f () -&gt; f ()) -&gt; f () -&gt; f ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; f ()
forall (m :: * -&gt; *) a a. (MonadFail m, Show a) =&gt; a -&gt; m a
</span><a href="#local-6989586621679405835"><span class="hs-identifier hs-var">unboundErr</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679405838"><span class="hs-identifier hs-var">tn</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621679405835"><span class="annot"><span class="annottext">unboundErr :: a -&gt; m a
</span><a href="#local-6989586621679405835"><span class="hs-identifier hs-var hs-var">unboundErr</span></a></span></span><span> </span><span id="local-6989586621679405834"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679405834"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; m a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m a) -&gt; String -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unbound type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679405834"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="annot"><a href="Codec.Candid.TH.html#quoteCandidService"><span class="hs-identifier hs-type">quoteCandidService</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span>
</span><span id="line-130"></span><span id="quoteCandidService"><span class="annot"><span class="annottext">quoteCandidService :: String -&gt; Q Type
</span><a href="Codec.Candid.TH.html#quoteCandidService"><span class="hs-identifier hs-var hs-var">quoteCandidService</span></a></span></span><span> </span><span id="local-6989586621679405833"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405833"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String DidFile
</span><a href="Codec.Candid.Parse.html#parseDid"><span class="hs-identifier hs-var">parseDid</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405833"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679405831"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405831"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Type
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405831"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#DidFile"><span class="hs-identifier hs-type">DidFile</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">service :: DidFile -&gt; DidService Text
</span><a href="Codec.Candid.Types.html#service"><span class="hs-identifier hs-var">service</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[t|</span><span class="hs-identifier">R.Empty</span><span class="hs-special">|]</span><span>
</span><span id="line-133"></span><span>  </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#DidFile"><span class="hs-identifier hs-type">DidFile</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">defs :: DidFile -&gt; [DidDef Text]
</span><a href="Codec.Candid.Types.html#defs"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679405827"><span class="annot"><span class="annottext">[DidDef Text]
</span><a href="#local-6989586621679405827"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">service :: DidFile -&gt; DidService Text
</span><a href="Codec.Candid.Types.html#service"><span class="hs-identifier hs-var">service</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679405826"><span class="annot"><span class="annottext">DidService Text
</span><a href="#local-6989586621679405826"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679405825"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679405825"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q (Maybe Name)
</span><a href=".."><span class="hs-identifier hs-var">lookupTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;m&quot;</span></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679405824"><span class="annot"><span class="annottext">[(Text, Type Void)]
</span><a href="#local-6989586621679405824"><span class="hs-identifier hs-var">_ds'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679405823"><span class="annot"><span class="annottext">Text -&gt; Q ()
</span><a href="#local-6989586621679405823"><span class="hs-identifier hs-var">check</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679405822"><span class="annot"><span class="annottext">Text -&gt; Type Void
</span><a href="#local-6989586621679405822"><span class="hs-identifier hs-var">inline</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[DidDef Text]
-&gt; Q ([(Text, Type Void)], Text -&gt; Q (), Text -&gt; Type Void)
forall k.
(Show k, Ord k) =&gt;
[DidDef k] -&gt; Q ([(k, Type Void)], k -&gt; Q (), k -&gt; Type Void)
</span><a href="Codec.Candid.TH.html#inlineDefs"><span class="hs-identifier hs-var">inlineDefs</span></a></span><span> </span><span class="annot"><span class="annottext">[DidDef Text]
</span><a href="#local-6989586621679405827"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><span class="annottext">DidService Text -&gt; ((Text, MethodType Text) -&gt; Q ()) -&gt; Q ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">for_</span></a></span><span> </span><span class="annot"><span class="annottext">DidService Text
</span><a href="#local-6989586621679405826"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(((Text, MethodType Text) -&gt; Q ()) -&gt; Q ())
-&gt; ((Text, MethodType Text) -&gt; Q ()) -&gt; Q ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679405821"><span class="annot"><span class="annottext">(Text, MethodType Text)
</span><a href="#local-6989586621679405821"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Text, MethodType Text) -&gt; (MethodType Text -&gt; Q ()) -&gt; Q ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">for_</span></a></span><span> </span><span class="annot"><span class="annottext">(Text, MethodType Text)
</span><a href="#local-6989586621679405821"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; Q ()) -&gt; MethodType Text -&gt; Q ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href=".."><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Q ()
</span><a href="#local-6989586621679405823"><span class="hs-identifier hs-var">check</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="annottext">(Q Type -&gt; Q Type -&gt; Q Type) -&gt; [Q Type] -&gt; Q Type
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">foldl1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679405818"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679405818"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679405817"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679405817"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">$(</span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-operator">R..+</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">|]</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">[t|</span><span>  </span><span class="hs-special">$(</span><span class="hs-identifier">litT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">strTyLit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">T.unpack</span><span> </span><span class="hs-identifier">methName</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>               </span><span class="hs-operator">R..==</span><span> </span><span class="hs-special">(</span><span class="hs-special">$(</span><span class="hs-identifier">candidTypeQ</span><span> </span><span class="hs-identifier">params</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">varT</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">candidTypeQ</span><span> </span><span class="hs-identifier">results</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-140"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679405816"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405816"><span class="hs-identifier hs-var">methName</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#MethodType"><span class="hs-identifier hs-type">MethodType</span></a></span><span class="hs-special">{</span><span id="local-6989586621679405810"><span id="local-6989586621679405811"><span id="local-6989586621679405812"><span id="local-6989586621679405813"><span id="local-6989586621679405814"><span class="annot"><span class="annottext">Bool
[Type Text]
methOneway :: forall a. MethodType a -&gt; Bool
methCompQuery :: forall a. MethodType a -&gt; Bool
methQuery :: forall a. MethodType a -&gt; Bool
methResults :: forall a. MethodType a -&gt; [Type a]
methParams :: forall a. MethodType a -&gt; [Type a]
methOneway :: Bool
methCompQuery :: Bool
methQuery :: Bool
methResults :: [Type Text]
methParams :: [Type Text]
</span><a href="Codec.Candid.Types.html#methOneway"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DidService Text
</span><a href="#local-6989586621679405826"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679405804"><span class="annot"><span class="annottext">params :: [Type b]
</span><a href="#local-6989586621679405804"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type Text -&gt; Type b) -&gt; [Type Text] -&gt; [Type b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href=".."><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Void -&gt; b
forall a. Void -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">absurd</span></a></span><span> </span><span class="annot"><span class="annottext">(Void -&gt; b) -&gt; Type Void -&gt; Type b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type Void -&gt; Type b)
-&gt; (Type Text -&gt; Type Void) -&gt; Type Text -&gt; Type b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href=".."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type Text -&gt; (Text -&gt; Type Void) -&gt; Type Void
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Type Void
</span><a href="#local-6989586621679405822"><span class="hs-identifier hs-var">inline</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type Text]
</span><a href="#local-6989586621679405814"><span class="hs-identifier hs-var">methParams</span></a></span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679405801"><span class="annot"><span class="annottext">results :: [Type b]
</span><a href="#local-6989586621679405801"><span class="hs-identifier hs-var hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type Text -&gt; Type b) -&gt; [Type Text] -&gt; [Type b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href=".."><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Void -&gt; b
forall a. Void -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">absurd</span></a></span><span> </span><span class="annot"><span class="annottext">(Void -&gt; b) -&gt; Type Void -&gt; Type b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type Void -&gt; Type b)
-&gt; (Type Text -&gt; Type Void) -&gt; Type Text -&gt; Type b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href=".."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type Text -&gt; (Text -&gt; Type Void) -&gt; Type Void
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Type Void
</span><a href="#local-6989586621679405822"><span class="hs-identifier hs-var">inline</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type Text]
</span><a href="#local-6989586621679405813"><span class="hs-identifier hs-var">methResults</span></a></span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-comment">-- TODO annotations</span><span>
</span><span id="line-144"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><a href="Codec.Candid.TH.html#quoteCandidDefs"><span class="hs-identifier hs-type">quoteCandidDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span>
</span><span id="line-147"></span><span id="quoteCandidDefs"><span class="annot"><span class="annottext">quoteCandidDefs :: String -&gt; Q Type
</span><a href="Codec.Candid.TH.html#quoteCandidDefs"><span class="hs-identifier hs-var hs-var">quoteCandidDefs</span></a></span></span><span> </span><span id="local-6989586621679405800"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405800"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String DidFile
</span><a href="Codec.Candid.Parse.html#parseDid"><span class="hs-identifier hs-var">parseDid</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405800"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679405799"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405799"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Type
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405799"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#DidFile"><span class="hs-identifier hs-type">DidFile</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">defs :: DidFile -&gt; [DidDef Text]
</span><a href="Codec.Candid.Types.html#defs"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[t|</span><span class="hs-identifier">R.Empty</span><span class="hs-special">|]</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#DidFile"><span class="hs-identifier hs-type">DidFile</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">defs :: DidFile -&gt; [DidDef Text]
</span><a href="Codec.Candid.Types.html#defs"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679405798"><span class="annot"><span class="annottext">[DidDef Text]
</span><a href="#local-6989586621679405798"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679405797"><span class="annot"><span class="annottext">[(Text, Type Void)]
</span><a href="#local-6989586621679405797"><span class="hs-identifier hs-var">ds'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679405796"><span class="annot"><span class="annottext">Text -&gt; Q ()
</span><a href="#local-6989586621679405796"><span class="hs-identifier hs-var">_check</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679405795"><span class="annot"><span class="annottext">Text -&gt; Type Void
</span><a href="#local-6989586621679405795"><span class="hs-identifier hs-var">_inline</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[DidDef Text]
-&gt; Q ([(Text, Type Void)], Text -&gt; Q (), Text -&gt; Type Void)
forall k.
(Show k, Ord k) =&gt;
[DidDef k] -&gt; Q ([(k, Type Void)], k -&gt; Q (), k -&gt; Type Void)
</span><a href="Codec.Candid.TH.html#inlineDefs"><span class="hs-identifier hs-var">inlineDefs</span></a></span><span> </span><span class="annot"><span class="annottext">[DidDef Text]
</span><a href="#local-6989586621679405798"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><span class="annottext">(Q Type -&gt; Q Type -&gt; Q Type) -&gt; [Q Type] -&gt; Q Type
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">foldl1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679405794"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679405794"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679405793"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679405793"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[t|</span><span class="hs-special">$(</span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-operator">R..+</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">|]</span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">[t|</span><span>  </span><span class="hs-special">$(</span><span class="hs-identifier">litT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">strTyLit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">T.unpack</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator">R..==</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">typ</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">absurd</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679405792"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405792"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679405791"><span class="annot"><span class="annottext">Type Void
</span><a href="#local-6989586621679405791"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Text, Type Void)]
</span><a href="#local-6989586621679405797"><span class="hs-identifier hs-var">ds'</span></a></span><span>
</span><span id="line-155"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="annot"><a href="Codec.Candid.TH.html#quoteCandidDefsSym"><span class="hs-identifier hs-type">quoteCandidDefsSym</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">DecsQ</span></a></span><span>
</span><span id="line-158"></span><span id="quoteCandidDefsSym"><span class="annot"><span class="annottext">quoteCandidDefsSym :: String -&gt; Q [Dec]
</span><a href="Codec.Candid.TH.html#quoteCandidDefsSym"><span class="hs-identifier hs-var hs-var">quoteCandidDefsSym</span></a></span></span><span> </span><span id="local-6989586621679405790"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405790"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String DidFile
</span><a href="Codec.Candid.Parse.html#parseDid"><span class="hs-identifier hs-var">parseDid</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405790"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679405789"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405789"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q [Dec]
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405789"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#DidFile"><span class="hs-identifier hs-type">DidFile</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">defs :: DidFile -&gt; [DidDef Text]
</span><a href="Codec.Candid.Types.html#defs"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679405788"><span class="annot"><span class="annottext">[DidDef Text]
</span><a href="#local-6989586621679405788"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><span class="annottext">[DidDef Text] -&gt; (DidDef Text -&gt; Q Dec) -&gt; Q [Dec]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href=".."><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">[DidDef Text]
</span><a href="#local-6989586621679405788"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">((DidDef Text -&gt; Q Dec) -&gt; Q [Dec])
-&gt; (DidDef Text -&gt; Q Dec) -&gt; Q [Dec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679405786"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405786"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679405785"><span class="annot"><span class="annottext">Type Text
</span><a href="#local-6989586621679405785"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBndr] -&gt; Q Type -&gt; Q Dec
</span><a href=".."><span class="hs-identifier hs-var">tySynD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Name
</span><a href="#local-6989586621679405783"><span class="hs-identifier hs-var">mangle</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405786"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type Name -&gt; Q Type
</span><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Name
</span><a href="#local-6989586621679405783"><span class="hs-identifier hs-var">mangle</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Name) -&gt; Type Text -&gt; Type Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type Text
</span><a href="#local-6989586621679405785"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><a href="#local-6989586621679405783"><span class="hs-identifier hs-type">mangle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">T.Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TH.Name</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621679405783"><span class="annot"><span class="annottext">mangle :: Text -&gt; Name
</span><a href="#local-6989586621679405783"><span class="hs-identifier hs-var hs-var">mangle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href=".."><span class="hs-identifier hs-var">mkName</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Name) -&gt; (Text -&gt; String) -&gt; Text -&gt; Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href=".."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">T.unpack</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="annot"><a href="Codec.Candid.TH.html#quoteCandidType"><span class="hs-identifier hs-type">quoteCandidType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span>
</span><span id="line-167"></span><span id="quoteCandidType"><span class="annot"><span class="annottext">quoteCandidType :: String -&gt; Q Type
</span><a href="Codec.Candid.TH.html#quoteCandidType"><span class="hs-identifier hs-var hs-var">quoteCandidType</span></a></span></span><span> </span><span id="local-6989586621679405782"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405782"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (Type Text)
</span><a href="Codec.Candid.Parse.html#parseDidType"><span class="hs-identifier hs-var">parseDidType</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405782"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679405780"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405780"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Type
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679405780"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679405779"><span class="annot"><span class="annottext">Type Text
</span><a href="#local-6989586621679405779"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type Name -&gt; Q Type
</span><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Name
forall a. Text -&gt; a
</span><a href="#local-6989586621679405778"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Name) -&gt; Type Text -&gt; Type Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type Text
</span><a href="#local-6989586621679405779"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-171"></span><span>     </span><span id="local-6989586621679405778"><span class="annot"><span class="annottext">err :: Text -&gt; a
</span><a href="#local-6989586621679405778"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span id="local-6989586621679405777"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405777"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; a) -&gt; String -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Type name in stand-alone Candid type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405777"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Codec.Candid.TH.html#candidTypeQ"><span class="hs-identifier hs-type">candidTypeQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TH.Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span>
</span><span id="line-174"></span><span id="candidTypeQ"><span class="annot"><span class="annottext">candidTypeQ :: [Type Name] -&gt; Q Type
</span><a href="Codec.Candid.TH.html#candidTypeQ"><span class="hs-identifier hs-var hs-var">candidTypeQ</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-175"></span><span class="annot"><a href="Codec.Candid.TH.html#candidTypeQ"><span class="hs-identifier hs-var">candidTypeQ</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#NullT"><span class="hs-identifier hs-var">NullT</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Unary</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-176"></span><span class="annot"><a href="Codec.Candid.TH.html#candidTypeQ"><span class="hs-identifier hs-var">candidTypeQ</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679405774"><span class="annot"><span class="annottext">t :: Type Name
</span><a href="#local-6989586621679405774"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#RecT"><span class="hs-identifier hs-type">RecT</span></a></span><span> </span><span id="local-6989586621679405772"><span class="annot"><span class="annottext">Fields Name
</span><a href="#local-6989586621679405772"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Fields Name -&gt; Bool
forall b. [(FieldName, b)] -&gt; Bool
</span><a href="Codec.Candid.TH.html#isTuple"><span class="hs-identifier hs-var">isTuple</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Name
</span><a href="#local-6989586621679405772"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Unary</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">typ</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-177"></span><span class="annot"><a href="Codec.Candid.TH.html#candidTypeQ"><span class="hs-identifier hs-var">candidTypeQ</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679405770"><span class="annot"><span class="annottext">Type Name
</span><a href="#local-6989586621679405770"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type Name -&gt; Q Type
</span><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="#local-6989586621679405770"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-178"></span><span class="annot"><a href="Codec.Candid.TH.html#candidTypeQ"><span class="hs-identifier hs-var">candidTypeQ</span></a></span><span> </span><span id="local-6989586621679405769"><span class="annot"><span class="annottext">[Type Name]
</span><a href="#local-6989586621679405769"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Q Type] -&gt; Q Type
</span><a href="Codec.Candid.TH.html#mkTupleT"><span class="hs-identifier hs-var">mkTupleT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type Name -&gt; Q Type) -&gt; [Type Name] -&gt; [Q Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href=".."><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name -&gt; Q Type
</span><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">[Type Name]
</span><a href="#local-6989586621679405769"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="annot"><a href="Codec.Candid.TH.html#row"><span class="hs-identifier hs-type">row</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Fields"><span class="hs-identifier hs-type">Fields</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TH.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span>
</span><span id="line-182"></span><span id="row"><span class="annot"><span class="annottext">row :: Q Type -&gt; Q Type -&gt; Q Type -&gt; Fields Name -&gt; Q Type
</span><a href="Codec.Candid.TH.html#row"><span class="hs-identifier hs-var hs-var">row</span></a></span></span><span> </span><span id="local-6989586621679405766"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679405766"><span class="hs-identifier hs-var">eq</span></a></span></span><span> </span><span id="local-6989586621679405765"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679405765"><span class="hs-identifier hs-var">add</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FieldName, Type Name) -&gt; Q Type -&gt; Q Type)
-&gt; Q Type -&gt; Fields Name -&gt; Q Type
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href=".."><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679405763"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679405763"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679405762"><span class="annot"><span class="annottext">Type Name
</span><a href="#local-6989586621679405762"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679405761"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679405761"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[t|</span><span>
</span><span id="line-183"></span><span>    </span><span class="">$add</span><span> </span><span class="hs-special">(</span><span class="">$eq</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">fieldName</span><span> </span><span class="hs-identifier">fn</span><span class="hs-special">)</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">typ</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="">$rest</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-special">|]</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><a href="#local-6989586621679405760"><span class="hs-identifier hs-type">fieldName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Candid.FieldName.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621679405760"><span class="annot"><span class="annottext">fieldName :: FieldName -&gt; Q Type
</span><a href="#local-6989586621679405760"><span class="hs-identifier hs-var hs-var">fieldName</span></a></span></span><span> </span><span id="local-6989586621679405759"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679405759"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLitQ -&gt; Q Type
</span><a href=".."><span class="hs-identifier hs-var">litT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLitQ
</span><a href=".."><span class="hs-identifier hs-var">strTyLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; Text
</span><a href="Codec.Candid.FieldName.html#escapeFieldName"><span class="hs-identifier hs-var">escapeFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679405759"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Codec.Candid.TH.html#mrow"><span class="hs-identifier hs-type">mrow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#MethodType"><span class="hs-identifier hs-type">MethodType</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TH.Name</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span>
</span><span id="line-190"></span><span id="mrow"><span class="annot"><span class="annottext">mrow :: Q Type -&gt; Q Type -&gt; Q Type -&gt; [(Text, MethodType Name)] -&gt; Q Type
</span><a href="Codec.Candid.TH.html#mrow"><span class="hs-identifier hs-var hs-var">mrow</span></a></span></span><span> </span><span id="local-6989586621679405756"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679405756"><span class="hs-identifier hs-var">eq</span></a></span></span><span> </span><span id="local-6989586621679405755"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679405755"><span class="hs-identifier hs-var">add</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Text, MethodType Name) -&gt; Q Type -&gt; Q Type)
-&gt; Q Type -&gt; [(Text, MethodType Name)] -&gt; Q Type
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href=".."><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679405754"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405754"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679405753"><span class="annot"><span class="annottext">MethodType Name
</span><a href="#local-6989586621679405753"><span class="hs-identifier hs-var">mt</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679405752"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679405752"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[t|</span><span>
</span><span id="line-191"></span><span>    </span><span class="">$add</span><span> </span><span class="hs-special">(</span><span class="">$eq</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">methodName</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">methodType</span><span> </span><span class="hs-identifier">mt</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="">$rest</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-special">|]</span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><a href="#local-6989586621679405751"><span class="hs-identifier hs-type">methodName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">T.Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span id="local-6989586621679405751"><span class="annot"><span class="annottext">methodName :: Text -&gt; Q Type
</span><a href="#local-6989586621679405751"><span class="hs-identifier hs-var hs-var">methodName</span></a></span></span><span> </span><span id="local-6989586621679405750"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405750"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLitQ -&gt; Q Type
</span><a href=".."><span class="hs-identifier hs-var">litT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLitQ
</span><a href=".."><span class="hs-identifier hs-var">strTyLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679405750"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><a href="Codec.Candid.TH.html#methodType"><span class="hs-identifier hs-type">methodType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#MethodType"><span class="hs-identifier hs-type">MethodType</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TH.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span>
</span><span id="line-198"></span><span id="methodType"><span class="annot"><span class="annottext">methodType :: MethodType Name -&gt; Q Type
</span><a href="Codec.Candid.TH.html#methodType"><span class="hs-identifier hs-var hs-var">methodType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#MethodType"><span class="hs-identifier hs-type">MethodType</span></a></span><span> </span><span id="local-6989586621679405748"><span class="annot"><span class="annottext">[Type Name]
</span><a href="#local-6989586621679405748"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679405747"><span class="annot"><span class="annottext">[Type Name]
</span><a href="#local-6989586621679405747"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679405746"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679405746"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679405745"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679405745"><span class="hs-identifier hs-var">cq</span></a></span></span><span> </span><span id="local-6989586621679405744"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679405744"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">(</span><span class="hs-special">$(</span><span class="hs-identifier">candidTypeQ</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">candidTypeQ</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">ann</span><span> </span><span class="hs-identifier">q</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">ann</span><span> </span><span class="hs-identifier">cq</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">ann</span><span> </span><span class="hs-identifier">o</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621679405743"><span class="annot"><span class="annottext">ann :: Bool -&gt; Q Type
</span><a href="#local-6989586621679405743"><span class="hs-identifier hs-var hs-var">ann</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span class="hs-identifier">AnnTrue</span><span class="hs-special">|]</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><a href="#local-6989586621679405743"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span class="hs-identifier">AnnFalse</span><span class="hs-special">|]</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="annot"><a href="Codec.Candid.TH.html#mkTupleT"><span class="hs-identifier hs-type">mkTupleT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span>
</span><span id="line-205"></span><span id="mkTupleT"><span class="annot"><span class="annottext">mkTupleT :: [Q Type] -&gt; Q Type
</span><a href="Codec.Candid.TH.html#mkTupleT"><span class="hs-identifier hs-var hs-var">mkTupleT</span></a></span></span><span> </span><span id="local-6989586621679405742"><span class="annot"><span class="annottext">[Q Type]
</span><a href="#local-6989586621679405742"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Q Type -&gt; Q Type -&gt; Q Type) -&gt; Q Type -&gt; [Q Type] -&gt; Q Type
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href=".."><span class="hs-identifier hs-var">foldl</span></a></span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
</span><a href=".."><span class="hs-identifier hs-var">appT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Q Type
</span><a href=".."><span class="hs-identifier hs-var">tupleT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Q Type] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href=".."><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Q Type]
</span><a href="#local-6989586621679405742"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Q Type]
</span><a href="#local-6989586621679405742"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-type">typ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TH.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">TypeQ</span></a></span><span>
</span><span id="line-209"></span><span id="typ"><span class="annot"><span class="annottext">typ :: Type Name -&gt; Q Type
</span><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var hs-var">typ</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#NatT"><span class="hs-identifier hs-var">NatT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Natural</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-210"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#Nat8T"><span class="hs-identifier hs-var">Nat8T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-211"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#Nat16T"><span class="hs-identifier hs-var">Nat16T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Word16</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-212"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#Nat32T"><span class="hs-identifier hs-var">Nat32T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Word32</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-213"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#Nat64T"><span class="hs-identifier hs-var">Nat64T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Word64</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-214"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#IntT"><span class="hs-identifier hs-var">IntT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Integer</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-215"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#Int8T"><span class="hs-identifier hs-var">Int8T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Int8</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-216"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#Int16T"><span class="hs-identifier hs-var">Int16T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Int16</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-217"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#Int32T"><span class="hs-identifier hs-var">Int32T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Int32</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-218"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#Int64T"><span class="hs-identifier hs-var">Int64T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Int64</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-219"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#Float32T"><span class="hs-identifier hs-var">Float32T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Float</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-220"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#Float64T"><span class="hs-identifier hs-var">Float64T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Double</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-221"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#BoolT"><span class="hs-identifier hs-var">BoolT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Bool</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-222"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#TextT"><span class="hs-identifier hs-var">TextT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">T.Text</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-223"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#NullT"><span class="hs-identifier hs-var">NullT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-224"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#ReservedT"><span class="hs-identifier hs-var">ReservedT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Reserved</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-225"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Void</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-226"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#PrincipalT"><span class="hs-identifier hs-var">PrincipalT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Principal</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-227"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#BlobT"><span class="hs-identifier hs-var">BlobT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">BS.ByteString</span><span class="hs-special">|]</span><span>
</span><span id="line-228"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#OptT"><span class="hs-identifier hs-type">OptT</span></a></span><span> </span><span id="local-6989586621679405720"><span class="annot"><span class="annottext">Type Name
</span><a href="#local-6989586621679405720"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">$(</span><span> </span><span class="hs-identifier">typ</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-229"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#VecT"><span class="hs-identifier hs-type">VecT</span></a></span><span> </span><span id="local-6989586621679405718"><span class="annot"><span class="annottext">Type Name
</span><a href="#local-6989586621679405718"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">V.Vector</span><span> </span><span class="hs-special">$(</span><span> </span><span class="hs-identifier">typ</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-230"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#RecT"><span class="hs-identifier hs-type">RecT</span></a></span><span> </span><span id="local-6989586621679405717"><span class="annot"><span class="annottext">Fields Name
</span><a href="#local-6989586621679405717"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Fields Name -&gt; Bool
forall b. [(FieldName, b)] -&gt; Bool
</span><a href="Codec.Candid.TH.html#isTuple"><span class="hs-identifier hs-var">isTuple</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Name
</span><a href="#local-6989586621679405717"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Q Type] -&gt; Q Type
</span><a href="Codec.Candid.TH.html#mkTupleT"><span class="hs-identifier hs-var">mkTupleT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((FieldName, Type Name) -&gt; Q Type) -&gt; Fields Name -&gt; [Q Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href=".."><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type Name -&gt; Q Type
</span><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">(Type Name -&gt; Q Type)
-&gt; ((FieldName, Type Name) -&gt; Type Name)
-&gt; (FieldName, Type Name)
-&gt; Q Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href=".."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldName, Type Name) -&gt; Type Name
forall a b. (a, b) -&gt; b
</span><a href=".."><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fields Name
</span><a href="#local-6989586621679405717"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">R.Rec</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">row</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">(</span><span class="hs-operator">R..==</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">(</span><span class="hs-operator">R..+</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">R.Empty</span><span> </span><span class="hs-special">|]</span><span> </span><span class="hs-identifier">fs</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-233"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#VariantT"><span class="hs-identifier hs-type">VariantT</span></a></span><span> </span><span id="local-6989586621679405715"><span class="annot"><span class="annottext">Fields Name
</span><a href="#local-6989586621679405715"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">V.Var</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">row</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">(</span><span class="hs-operator">V..==</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">(</span><span class="hs-operator">V..+</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">V.Empty</span><span> </span><span class="hs-special">|]</span><span> </span><span class="hs-identifier">fs</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-234"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#FuncT"><span class="hs-identifier hs-type">FuncT</span></a></span><span> </span><span id="local-6989586621679405713"><span class="annot"><span class="annottext">MethodType Name
</span><a href="#local-6989586621679405713"><span class="hs-identifier hs-var">mt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">FuncRef</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">methodType</span><span> </span><span class="hs-identifier">mt</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-235"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#ServiceT"><span class="hs-identifier hs-type">ServiceT</span></a></span><span> </span><span id="local-6989586621679405711"><span class="annot"><span class="annottext">[(Text, MethodType Name)]
</span><a href="#local-6989586621679405711"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">ServiceRef</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">mrow</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">(</span><span class="hs-operator">R..==</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-special">(</span><span class="hs-operator">R..+</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span> </span><span class="hs-special">[t|</span><span> </span><span class="hs-identifier">R.Empty</span><span> </span><span class="hs-special">|]</span><span> </span><span class="hs-identifier">ms</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-236"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type Name
</span><a href="Codec.Candid.Types.html#FutureT"><span class="hs-identifier hs-var">FutureT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Type
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot represent a future Candid type as a Haskell type&quot;</span></span><span>
</span><span id="line-237"></span><span class="annot"><a href="Codec.Candid.TH.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#RefT"><span class="hs-identifier hs-type">RefT</span></a></span><span> </span><span id="local-6989586621679405708"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679405708"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
</span><a href=".."><span class="hs-identifier hs-var">conT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679405708"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span id="local-6989586621679405921"><span class="annot"><a href="Codec.Candid.TH.html#isTuple"><span class="hs-identifier hs-type">isTuple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.FieldName.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679405921"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-240"></span><span id="isTuple"><span class="annot"><span class="annottext">isTuple :: [(FieldName, b)] -&gt; Bool
</span><a href="Codec.Candid.TH.html#isTuple"><span class="hs-identifier hs-var hs-var">isTuple</span></a></span></span><span> </span><span id="local-6989586621679405707"><span class="annot"><span class="annottext">[(FieldName, b)]
</span><a href="#local-6989586621679405707"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(FieldName, b)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href=".."><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[(FieldName, b)]
</span><a href="#local-6989586621679405707"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><a href=".."><span class="hs-identifier hs-var">and</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FieldName -&gt; FieldName -&gt; Bool)
-&gt; [FieldName] -&gt; [FieldName] -&gt; [Bool]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href=".."><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; FieldName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">(==)</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((FieldName, b) -&gt; FieldName) -&gt; [(FieldName, b)] -&gt; [FieldName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href=".."><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldName, b) -&gt; FieldName
forall a b. (a, b) -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(FieldName, b)]
</span><a href="#local-6989586621679405707"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word32 -&gt; FieldName) -&gt; [Word32] -&gt; [FieldName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href=".."><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; FieldName
</span><a href="Codec.Candid.FieldName.html#hashedField"><span class="hs-identifier hs-var">hashedField</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span></pre></body></html>