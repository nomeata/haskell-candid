<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Codec.Candid.Decode</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Numeric.Natural</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Vector</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Text.Encoding</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.List</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Void</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Serialize.LEB128.Lenient</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Serialize.Get</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Data.Serialize.IEEE754</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Candid.Data.html"><span class="hs-identifier">Codec.Candid.Data</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Candid.TypTable.html"><span class="hs-identifier">Codec.Candid.TypTable</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html"><span class="hs-identifier">Codec.Candid.Types</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Candid.FieldName.html"><span class="hs-identifier">Codec.Candid.FieldName</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">-- | Decode binay value into the type description and the untyped value</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- representation.</span><span>
</span><span id="line-28"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVals"><span class="hs-identifier hs-type">decodeVals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.TypTable.html#SeqDesc"><span class="hs-identifier hs-type">SeqDesc</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Candid.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span id="decodeVals"><span class="annot"><span class="annottext">decodeVals :: ByteString -&gt; Either String (SeqDesc, [Value])
</span><a href="Codec.Candid.Decode.html#decodeVals"><span class="hs-identifier hs-var hs-var">decodeVals</span></a></span></span><span> </span><span id="local-6989586621679403598"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679403598"><span class="hs-identifier hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get (SeqDesc, [Value])
-&gt; ByteString -&gt; Either String (SeqDesc, [Value])
forall a. Get a -&gt; ByteString -&gt; Either String a
</span><a href=".."><span class="hs-identifier hs-var">G.runGet</span></a></span><span> </span><span class="annot"><span class="annottext">Get (SeqDesc, [Value])
</span><a href="#local-6989586621679403596"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href=".."><span class="hs-identifier hs-var">BS.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679403598"><span class="hs-identifier hs-var">bytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-31"></span><span>    </span><span id="local-6989586621679403596"><span class="annot"><span class="annottext">go :: Get (SeqDesc, [Value])
</span><a href="#local-6989586621679403596"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><span class="annottext">Get ()
</span><a href="Codec.Candid.Decode.html#decodeMagic"><span class="hs-identifier hs-var">decodeMagic</span></a></span><span>
</span><span id="line-33"></span><span>        </span><span id="local-6989586621679403593"><span class="annot"><span class="annottext">SeqDesc
</span><a href="#local-6989586621679403593"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get SeqDesc
</span><a href="Codec.Candid.Decode.html#decodeTypTable"><span class="hs-identifier hs-var">decodeTypTable</span></a></span><span>
</span><span id="line-34"></span><span>        </span><span id="local-6989586621679403591"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679403591"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Type Void -&gt; Get Value) -&gt; [Type Void] -&gt; Get [Value]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href=".."><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void -&gt; Get Value
</span><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SeqDesc -&gt; [Type Void]
</span><a href="Codec.Candid.TypTable.html#tieKnot"><span class="hs-identifier hs-var">tieKnot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SeqDesc -&gt; SeqDesc
</span><a href="Codec.Candid.TypTable.html#voidEmptyTypes"><span class="hs-identifier hs-var">voidEmptyTypes</span></a></span><span> </span><span class="annot"><span class="annottext">SeqDesc
</span><a href="#local-6989586621679403593"><span class="hs-identifier hs-var">arg_tys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679403586"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679403586"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Int
</span><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-var">countZeroSizeVectors</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Int) -&gt; [Value] -&gt; [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679403591"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Get () -&gt; Get ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403586"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2_000_000</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Get () -&gt; Get ()) -&gt; Get () -&gt; Get ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-37"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; Get ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Get ()) -&gt; String -&gt; Get ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Message contains &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403586"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; zero sized values in a vector, exceeding the limit of 2_000_000&quot;</span></span><span>
</span><span id="line-38"></span><span>        </span><span class="annot"><span class="annottext">Get Int
</span><a href=".."><span class="hs-identifier hs-var">G.remaining</span></a></span><span> </span><span class="annot"><span class="annottext">Get Int
-&gt; (Int -&gt; Get (SeqDesc, [Value])) -&gt; Get (SeqDesc, [Value])
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-39"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SeqDesc, [Value]) -&gt; Get (SeqDesc, [Value])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SeqDesc
</span><a href="#local-6989586621679403593"><span class="hs-identifier hs-var">arg_tys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679403591"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>            </span><span id="local-6989586621679403578"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403578"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get (SeqDesc, [Value])
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Get (SeqDesc, [Value]))
-&gt; String -&gt; Get (SeqDesc, [Value])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unexpected &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403578"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; left-over bytes&quot;</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-type">decodeVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Void</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-43"></span><span id="decodeVal"><span class="annot"><span class="annottext">decodeVal :: Type Void -&gt; Get Value
</span><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var hs-var">decodeVal</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#BoolT"><span class="hs-identifier hs-var">BoolT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><a href=".."><span class="hs-identifier hs-var">G.getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">Get Word8 -&gt; (Word8 -&gt; Get Value) -&gt; Get Value
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Get Value
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Get Value) -&gt; Value -&gt; Get Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Value
</span><a href="Codec.Candid.Types.html#BoolV"><span class="hs-identifier hs-var">BoolV</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Get Value
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Get Value) -&gt; Value -&gt; Get Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Value
</span><a href="Codec.Candid.Types.html#BoolV"><span class="hs-identifier hs-var">BoolV</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get Value
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid boolean value&quot;</span></span><span>
</span><span id="line-47"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#NatT"><span class="hs-identifier hs-var">NatT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Value
</span><a href="Codec.Candid.Types.html#NatV"><span class="hs-identifier hs-var">NatV</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Value) -&gt; Get Natural -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Natural
forall a. LEB128 a =&gt; Get a
</span><a href=".."><span class="hs-identifier hs-var">getLEB128</span></a></span><span>
</span><span id="line-48"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#Nat8T"><span class="hs-identifier hs-var">Nat8T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Value
</span><a href="Codec.Candid.Types.html#Nat8V"><span class="hs-identifier hs-var">Nat8V</span></a></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Value) -&gt; Get Word8 -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><a href=".."><span class="hs-identifier hs-var">G.getWord8</span></a></span><span>
</span><span id="line-49"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#Nat16T"><span class="hs-identifier hs-var">Nat16T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Value
</span><a href="Codec.Candid.Types.html#Nat16V"><span class="hs-identifier hs-var">Nat16V</span></a></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Value) -&gt; Get Word16 -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><a href=".."><span class="hs-identifier hs-var">G.getWord16le</span></a></span><span>
</span><span id="line-50"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#Nat32T"><span class="hs-identifier hs-var">Nat32T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Value
</span><a href="Codec.Candid.Types.html#Nat32V"><span class="hs-identifier hs-var">Nat32V</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Value) -&gt; Get Word32 -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Word32
</span><a href=".."><span class="hs-identifier hs-var">G.getWord32le</span></a></span><span>
</span><span id="line-51"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#Nat64T"><span class="hs-identifier hs-var">Nat64T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Value
</span><a href="Codec.Candid.Types.html#Nat64V"><span class="hs-identifier hs-var">Nat64V</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Value) -&gt; Get Word64 -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Word64
</span><a href=".."><span class="hs-identifier hs-var">G.getWord64le</span></a></span><span>
</span><span id="line-52"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#IntT"><span class="hs-identifier hs-var">IntT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Value
</span><a href="Codec.Candid.Types.html#IntV"><span class="hs-identifier hs-var">IntV</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Value) -&gt; Get Integer -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Integer
forall a. SLEB128 a =&gt; Get a
</span><a href=".."><span class="hs-identifier hs-var">getSLEB128</span></a></span><span>
</span><span id="line-53"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#Int8T"><span class="hs-identifier hs-var">Int8T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int8 -&gt; Value
</span><a href="Codec.Candid.Types.html#Int8V"><span class="hs-identifier hs-var">Int8V</span></a></span><span> </span><span class="annot"><span class="annottext">(Int8 -&gt; Value) -&gt; Get Int8 -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Int8
</span><a href=".."><span class="hs-identifier hs-var">G.getInt8</span></a></span><span>
</span><span id="line-54"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#Int16T"><span class="hs-identifier hs-var">Int16T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Value
</span><a href="Codec.Candid.Types.html#Int16V"><span class="hs-identifier hs-var">Int16V</span></a></span><span> </span><span class="annot"><span class="annottext">(Int16 -&gt; Value) -&gt; Get Int16 -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Int16
</span><a href=".."><span class="hs-identifier hs-var">G.getInt16le</span></a></span><span>
</span><span id="line-55"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#Int32T"><span class="hs-identifier hs-var">Int32T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Value
</span><a href="Codec.Candid.Types.html#Int32V"><span class="hs-identifier hs-var">Int32V</span></a></span><span> </span><span class="annot"><span class="annottext">(Int32 -&gt; Value) -&gt; Get Int32 -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Int32
</span><a href=".."><span class="hs-identifier hs-var">G.getInt32le</span></a></span><span>
</span><span id="line-56"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#Int64T"><span class="hs-identifier hs-var">Int64T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Value
</span><a href="Codec.Candid.Types.html#Int64V"><span class="hs-identifier hs-var">Int64V</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Value) -&gt; Get Int64 -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Int64
</span><a href=".."><span class="hs-identifier hs-var">G.getInt64le</span></a></span><span>
</span><span id="line-57"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#Float32T"><span class="hs-identifier hs-var">Float32T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Value
</span><a href="Codec.Candid.Types.html#Float32V"><span class="hs-identifier hs-var">Float32V</span></a></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Value) -&gt; Get Float -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Float
</span><a href=".."><span class="hs-identifier hs-var">G.getFloat32le</span></a></span><span>
</span><span id="line-58"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#Float64T"><span class="hs-identifier hs-var">Float64T</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Value
</span><a href="Codec.Candid.Types.html#Float64V"><span class="hs-identifier hs-var">Float64V</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Value) -&gt; Get Double -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Double
</span><a href=".."><span class="hs-identifier hs-var">G.getFloat64le</span></a></span><span>
</span><span id="line-59"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#TextT"><span class="hs-identifier hs-var">TextT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><a href="Codec.Candid.Types.html#TextV"><span class="hs-identifier hs-var">TextV</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Value) -&gt; Get Text -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Text
</span><a href="Codec.Candid.Decode.html#decodeText"><span class="hs-identifier hs-var">decodeText</span></a></span><span>
</span><span id="line-60"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#NullT"><span class="hs-identifier hs-var">NullT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Get Value
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="Codec.Candid.Types.html#NullV"><span class="hs-identifier hs-var">NullV</span></a></span><span>
</span><span id="line-61"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#ReservedT"><span class="hs-identifier hs-var">ReservedT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Get Value
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="Codec.Candid.Types.html#ReservedV"><span class="hs-identifier hs-var">ReservedV</span></a></span><span>
</span><span id="line-62"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#OptT"><span class="hs-identifier hs-type">OptT</span></a></span><span> </span><span id="local-6989586621679403531"><span class="annot"><span class="annottext">Type Void
</span><a href="#local-6989586621679403531"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><a href=".."><span class="hs-identifier hs-var">G.getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">Get Word8 -&gt; (Word8 -&gt; Get Value) -&gt; Get Value
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Get Value
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Get Value) -&gt; Value -&gt; Get Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Value -&gt; Value
</span><a href="Codec.Candid.Types.html#OptV"><span class="hs-identifier hs-var">OptV</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Value
forall a. Maybe a
</span><a href=".."><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Value -&gt; Value
</span><a href="Codec.Candid.Types.html#OptV"><span class="hs-identifier hs-var">OptV</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Value -&gt; Value) -&gt; (Value -&gt; Maybe Value) -&gt; Value -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href=".."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe Value
forall a. a -&gt; Maybe a
</span><a href=".."><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Value) -&gt; Get Value -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void -&gt; Get Value
</span><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="#local-6989586621679403531"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get Value
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid optional value&quot;</span></span><span>
</span><span id="line-66"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#BlobT"><span class="hs-identifier hs-var">BlobT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Value
</span><a href="Codec.Candid.Types.html#BlobV"><span class="hs-identifier hs-var">BlobV</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Value) -&gt; Get ByteString -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get ByteString
</span><a href="Codec.Candid.Decode.html#decodeBytes"><span class="hs-identifier hs-var">decodeBytes</span></a></span><span>
</span><span id="line-67"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#VecT"><span class="hs-identifier hs-type">VecT</span></a></span><span> </span><span id="local-6989586621679403524"><span class="annot"><span class="annottext">Type Void
</span><a href="#local-6989586621679403524"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-68"></span><span>    </span><span id="local-6989586621679403523"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403523"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Int
forall a. Integral a =&gt; Get a
</span><a href="Codec.Candid.Decode.html#getLEB128Int"><span class="hs-identifier hs-var">getLEB128Int</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type Void -&gt; Maybe Value
forall a. Type a -&gt; Maybe Value
</span><a href="Codec.Candid.Decode.html#decodeZeroBytes"><span class="hs-identifier hs-var">decodeZeroBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="#local-6989586621679403524"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-70"></span><span>        </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679403520"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679403520"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="annottext">Value -&gt; Get Value
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Get Value) -&gt; Value -&gt; Get Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Value -&gt; Value
</span><a href="Codec.Candid.Types.html#RepeatV"><span class="hs-identifier hs-var">RepeatV</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403523"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679403520"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-71"></span><span>        </span><span class="annot"><span class="annottext">Maybe Value
</span><a href=".."><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector Value -&gt; Value
</span><a href="Codec.Candid.Types.html#VecV"><span class="hs-identifier hs-var">VecV</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Value -&gt; Value)
-&gt; ([Value] -&gt; Vector Value) -&gt; [Value] -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href=".."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Vector Value
forall a. [a] -&gt; Vector a
</span><a href=".."><span class="hs-identifier hs-var">V.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; Get [Value] -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get Value -&gt; Get [Value]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href=".."><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403523"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type Void -&gt; Get Value
</span><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="#local-6989586621679403524"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#RecT"><span class="hs-identifier hs-type">RecT</span></a></span><span> </span><span id="local-6989586621679403514"><span class="annot"><span class="annottext">Fields Void
</span><a href="#local-6989586621679403514"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679403513"><span class="hs-identifier hs-var">isTuple</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
</span><a href="Codec.Candid.Types.html#TupV"><span class="hs-identifier hs-var">TupV</span></a></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; Get [Value] -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((FieldName, Type Void) -&gt; Get Value) -&gt; Fields Void -&gt; Get [Value]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href=".."><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679403511"><span class="annot"><span class="annottext">Type Void
</span><a href="#local-6989586621679403511"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type Void -&gt; Get Value
</span><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="#local-6989586621679403511"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fields Void
</span><a href="#local-6989586621679403510"><span class="hs-identifier hs-var">fs'</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(FieldName, Value)] -&gt; Value
</span><a href="Codec.Candid.Types.html#RecV"><span class="hs-identifier hs-var">RecV</span></a></span><span> </span><span class="annot"><span class="annottext">([(FieldName, Value)] -&gt; Value)
-&gt; Get [(FieldName, Value)] -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((FieldName, Type Void) -&gt; Get (FieldName, Value))
-&gt; Fields Void -&gt; Get [(FieldName, Value)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href=".."><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679403508"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679403508"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679403507"><span class="annot"><span class="annottext">Type Void
</span><a href="#local-6989586621679403507"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679403508"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Value -&gt; (FieldName, Value))
-&gt; Get Value -&gt; Get (FieldName, Value)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void -&gt; Get Value
</span><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="#local-6989586621679403507"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fields Void
</span><a href="#local-6989586621679403510"><span class="hs-identifier hs-var">fs'</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>    </span><span id="local-6989586621679403510"><span class="annot"><span class="annottext">fs' :: Fields Void
</span><a href="#local-6989586621679403510"><span class="hs-identifier hs-var hs-var">fs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FieldName, Type Void) -&gt; FieldName) -&gt; Fields Void -&gt; Fields Void
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-identifier hs-var">sortOn</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldName, Type Void) -&gt; FieldName
forall a b. (a, b) -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Void
</span><a href="#local-6989586621679403514"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679403513"><span class="annot"><span class="annottext">isTuple :: Bool
</span><a href="#local-6989586621679403513"><span class="hs-identifier hs-var hs-var">isTuple</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><a href=".."><span class="hs-identifier hs-var">and</span></a></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; [Bool] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldName -&gt; FieldName -&gt; Bool)
-&gt; [FieldName] -&gt; [FieldName] -&gt; [Bool]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href=".."><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; FieldName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">(==)</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((FieldName, Type Void) -&gt; FieldName) -&gt; Fields Void -&gt; [FieldName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href=".."><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldName, Type Void) -&gt; FieldName
forall a b. (a, b) -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Void
</span><a href="#local-6989586621679403510"><span class="hs-identifier hs-var">fs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word32 -&gt; FieldName) -&gt; [Word32] -&gt; [FieldName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href=".."><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; FieldName
</span><a href="Codec.Candid.FieldName.html#hashedField"><span class="hs-identifier hs-var">hashedField</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#VariantT"><span class="hs-identifier hs-type">VariantT</span></a></span><span> </span><span id="local-6989586621679403501"><span class="annot"><span class="annottext">Fields Void
</span><a href="#local-6989586621679403501"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679403500"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403500"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Int
forall a. Integral a =&gt; Get a
</span><a href="Codec.Candid.Decode.html#getLEB128Int"><span class="hs-identifier hs-var">getLEB128Int</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Get () -&gt; Get ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403500"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Void -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href=".."><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Void
</span><a href="#local-6989586621679403501"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Get () -&gt; Get ()) -&gt; Get () -&gt; Get ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Get ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;variant index out of bound&quot;</span></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679403496"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679403496"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679403495"><span class="annot"><span class="annottext">Type Void
</span><a href="#local-6989586621679403495"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fields Void
</span><a href="#local-6989586621679403494"><span class="hs-identifier hs-var">fs'</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Void -&gt; Int -&gt; (FieldName, Type Void)
forall a. [a] -&gt; Int -&gt; a
</span><a href=".."><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403500"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="annottext">FieldName -&gt; Value -&gt; Value
</span><a href="Codec.Candid.Types.html#VariantV"><span class="hs-identifier hs-var">VariantV</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679403496"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Value) -&gt; Get Value -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void -&gt; Get Value
</span><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="#local-6989586621679403495"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>    </span><span id="local-6989586621679403494"><span class="annot"><span class="annottext">fs' :: Fields Void
</span><a href="#local-6989586621679403494"><span class="hs-identifier hs-var hs-var">fs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FieldName, Type Void) -&gt; FieldName) -&gt; Fields Void -&gt; Fields Void
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-identifier hs-var">sortOn</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldName, Type Void) -&gt; FieldName
forall a b. (a, b) -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Void
</span><a href="#local-6989586621679403501"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-85"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#FuncT"><span class="hs-identifier hs-type">FuncT</span></a></span><span> </span><span class="annot"><span class="annottext">MethodType Void
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><span class="annottext">Get ()
</span><a href="Codec.Candid.Decode.html#referenceByte"><span class="hs-identifier hs-var">referenceByte</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="annottext">Get ()
</span><a href="Codec.Candid.Decode.html#referenceByte"><span class="hs-identifier hs-var">referenceByte</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="annottext">Principal -&gt; Text -&gt; Value
</span><a href="Codec.Candid.Types.html#FuncV"><span class="hs-identifier hs-var">FuncV</span></a></span><span> </span><span class="annot"><span class="annottext">(Principal -&gt; Text -&gt; Value)
-&gt; Get Principal -&gt; Get (Text -&gt; Value)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Principal
</span><a href="Codec.Candid.Decode.html#decodePrincipal"><span class="hs-identifier hs-var">decodePrincipal</span></a></span><span> </span><span class="annot"><span class="annottext">Get (Text -&gt; Value) -&gt; Get Text -&gt; Get Value
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Text
</span><a href="Codec.Candid.Decode.html#decodeText"><span class="hs-identifier hs-var">decodeText</span></a></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#ServiceT"><span class="hs-identifier hs-type">ServiceT</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, MethodType Void)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><span class="annottext">Get ()
</span><a href="Codec.Candid.Decode.html#referenceByte"><span class="hs-identifier hs-var">referenceByte</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="annottext">Principal -&gt; Value
</span><a href="Codec.Candid.Types.html#ServiceV"><span class="hs-identifier hs-var">ServiceV</span></a></span><span> </span><span class="annot"><span class="annottext">(Principal -&gt; Value) -&gt; Get Principal -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Principal
</span><a href="Codec.Candid.Decode.html#decodePrincipal"><span class="hs-identifier hs-var">decodePrincipal</span></a></span><span>
</span><span id="line-92"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#PrincipalT"><span class="hs-identifier hs-var">PrincipalT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="annottext">Get ()
</span><a href="Codec.Candid.Decode.html#referenceByte"><span class="hs-identifier hs-var">referenceByte</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="annottext">Principal -&gt; Value
</span><a href="Codec.Candid.Types.html#PrincipalV"><span class="hs-identifier hs-var">PrincipalV</span></a></span><span> </span><span class="annot"><span class="annottext">(Principal -&gt; Value) -&gt; Get Principal -&gt; Get Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Principal
</span><a href="Codec.Candid.Decode.html#decodePrincipal"><span class="hs-identifier hs-var">decodePrincipal</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get Value
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Empty value&quot;</span></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><a href="Codec.Candid.Types.html#FutureT"><span class="hs-identifier hs-var">FutureT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621679403481"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679403481"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Int64
forall a. Integral a =&gt; Get a
</span><a href="Codec.Candid.Decode.html#getLEB128Int"><span class="hs-identifier hs-var">getLEB128Int</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621679403480"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403480"><span class="hs-identifier hs-var">_n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integral Natural =&gt; Get Natural
forall a. Integral a =&gt; Get a
</span><a href="Codec.Candid.Decode.html#getLEB128Int"><span class="hs-identifier hs-var">getLEB128Int</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Get ByteString
</span><a href=".."><span class="hs-identifier hs-var">G.getLazyByteString</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679403481"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">Value -&gt; Get Value
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="Codec.Candid.Types.html#FutureV"><span class="hs-identifier hs-var">FutureV</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeVal"><span class="hs-identifier hs-var">decodeVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#RefT"><span class="hs-identifier hs-type">RefT</span></a></span><span> </span><span id="local-6989586621679403476"><span class="annot"><span class="annottext">Void
</span><a href="#local-6989586621679403476"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Void -&gt; Get Value
forall a. Void -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">absurd</span></a></span><span> </span><span class="annot"><span class="annottext">Void
</span><a href="#local-6989586621679403476"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="annot"><a href="Codec.Candid.Decode.html#referenceByte"><span class="hs-identifier hs-type">referenceByte</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span id="referenceByte"><span class="annot"><span class="annottext">referenceByte :: Get ()
</span><a href="Codec.Candid.Decode.html#referenceByte"><span class="hs-identifier hs-var hs-var">referenceByte</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><a href=".."><span class="hs-identifier hs-var">G.getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">Get Word8 -&gt; (Word8 -&gt; Get ()) -&gt; Get ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;reference encountered&quot;</span></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Get ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;invalid reference tag&quot;</span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeBytes"><span class="hs-identifier hs-type">decodeBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-112"></span><span id="decodeBytes"><span class="annot"><span class="annottext">decodeBytes :: Get ByteString
</span><a href="Codec.Candid.Decode.html#decodeBytes"><span class="hs-identifier hs-var hs-var">decodeBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get Int64
forall a. Integral a =&gt; Get a
</span><a href="Codec.Candid.Decode.html#getLEB128Int"><span class="hs-identifier hs-var">getLEB128Int</span></a></span><span> </span><span class="annot"><span class="annottext">Get Int64 -&gt; (Int64 -&gt; Get ByteString) -&gt; Get ByteString
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Get ByteString
</span><a href=".."><span class="hs-identifier hs-var">G.getLazyByteString</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeText"><span class="hs-identifier hs-type">decodeText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">T.Text</span></a></span><span>
</span><span id="line-115"></span><span id="decodeText"><span class="annot"><span class="annottext">decodeText :: Get Text
</span><a href="Codec.Candid.Decode.html#decodeText"><span class="hs-identifier hs-var hs-var">decodeText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621679403474"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679403474"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get ByteString
</span><a href="Codec.Candid.Decode.html#decodeBytes"><span class="hs-identifier hs-var">decodeBytes</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either UnicodeException Text
</span><a href=".."><span class="hs-identifier hs-var">T.decodeUtf8'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href=".."><span class="hs-identifier hs-var">BS.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679403474"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-118"></span><span>        </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679403472"><span class="annot"><span class="annottext">UnicodeException
</span><a href="#local-6989586621679403472"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get Text
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Get Text) -&gt; String -&gt; Get Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid utf8: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">UnicodeException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">UnicodeException
</span><a href="#local-6989586621679403472"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679403471"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679403471"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Get Text
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679403471"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodePrincipal"><span class="hs-identifier hs-type">decodePrincipal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-type">Principal</span></a></span><span>
</span><span id="line-122"></span><span id="decodePrincipal"><span class="annot"><span class="annottext">decodePrincipal :: Get Principal
</span><a href="Codec.Candid.Decode.html#decodePrincipal"><span class="hs-identifier hs-var hs-var">decodePrincipal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Principal
</span><a href="Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-var">Principal</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Principal) -&gt; Get ByteString -&gt; Get Principal
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get ByteString
</span><a href="Codec.Candid.Decode.html#decodeBytes"><span class="hs-identifier hs-var">decodeBytes</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeMagic"><span class="hs-identifier hs-type">decodeMagic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span id="decodeMagic"><span class="annot"><span class="annottext">decodeMagic :: Get ()
</span><a href="Codec.Candid.Decode.html#decodeMagic"><span class="hs-identifier hs-var hs-var">decodeMagic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621679403469"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679403469"><span class="hs-identifier hs-var">magic</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><a href=".."><span class="hs-identifier hs-var">G.getBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Get () -&gt; Get ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679403469"><span class="hs-identifier hs-var">magic</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href=".."><span class="hs-identifier hs-var">T.encodeUtf8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href=".."><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DIDL&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Get () -&gt; Get ()) -&gt; Get () -&gt; Get ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Get ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Get ()) -&gt; String -&gt; Get ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected magic bytes \&quot;DIDL\&quot;, got &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679403469"><span class="hs-identifier hs-var">magic</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span id="local-6989586621679403666"><span class="annot"><a href="Codec.Candid.Decode.html#getLEB128Int"><span class="hs-identifier hs-type">getLEB128Int</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403666"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403666"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-131"></span><span id="getLEB128Int"><span class="annot"><span class="annottext">getLEB128Int :: Get a
</span><a href="Codec.Candid.Decode.html#getLEB128Int"><span class="hs-identifier hs-var hs-var">getLEB128Int</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href=".."><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; a) -&gt; Get Natural -&gt; Get a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LEB128 Natural =&gt; Get Natural
forall a. LEB128 a =&gt; Get a
</span><a href=".."><span class="hs-identifier hs-var">getLEB128</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- eagerly detect overshoot</span><span>
</span><span id="line-134"></span><span class="annot"><a href="Codec.Candid.Decode.html#checkOvershoot"><span class="hs-identifier hs-type">checkOvershoot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span id="checkOvershoot"><span class="annot"><span class="annottext">checkOvershoot :: Natural -&gt; Get ()
</span><a href="Codec.Candid.Decode.html#checkOvershoot"><span class="hs-identifier hs-var hs-var">checkOvershoot</span></a></span></span><span> </span><span id="local-6989586621679403464"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403464"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get ByteString -&gt; Get ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Get ByteString -&gt; Get ByteString
forall a. Get a -&gt; Get a
</span><a href=".."><span class="hs-identifier hs-var">G.lookAhead</span></a></span><span> </span><span class="annot"><span class="annottext">(Get ByteString -&gt; Get ByteString)
-&gt; Get ByteString -&gt; Get ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><a href=".."><span class="hs-identifier hs-var">G.ensure</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Get ByteString) -&gt; Int -&gt; Get ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href=".."><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403464"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621679403621"><span class="annot"><a href="Codec.Candid.Decode.html#decodeSeq"><span class="hs-identifier hs-type">decodeSeq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403621"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679403621"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-138"></span><span id="decodeSeq"><span class="annot"><span class="annottext">decodeSeq :: Get a -&gt; Get [a]
</span><a href="Codec.Candid.Decode.html#decodeSeq"><span class="hs-identifier hs-var hs-var">decodeSeq</span></a></span></span><span> </span><span id="local-6989586621679403459"><span class="annot"><span class="annottext">Get a
</span><a href="#local-6989586621679403459"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679403458"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403458"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Int
forall a. Integral a =&gt; Get a
</span><a href="Codec.Candid.Decode.html#getLEB128Int"><span class="hs-identifier hs-var">getLEB128Int</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="annottext">Natural -&gt; Get ()
</span><a href="Codec.Candid.Decode.html#checkOvershoot"><span class="hs-identifier hs-var">checkOvershoot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href=".."><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403458"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Get a -&gt; Get [a]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href=".."><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403458"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Get a
</span><a href="#local-6989586621679403459"><span class="hs-identifier hs-var">act</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span id="local-6989586621679403615"><span class="annot"><a href="Codec.Candid.Decode.html#decodeFoldSeq"><span class="hs-identifier hs-type">decodeFoldSeq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403615"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403615"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403615"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403615"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-144"></span><span id="decodeFoldSeq"><span class="annot"><span class="annottext">decodeFoldSeq :: (a -&gt; Get a) -&gt; a -&gt; Get a
</span><a href="Codec.Candid.Decode.html#decodeFoldSeq"><span class="hs-identifier hs-var hs-var">decodeFoldSeq</span></a></span></span><span> </span><span id="local-6989586621679403456"><span class="annot"><span class="annottext">a -&gt; Get a
</span><a href="#local-6989586621679403456"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span id="local-6989586621679403455"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403455"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621679403454"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679403454"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integral Integer =&gt; Get Integer
forall a. Integral a =&gt; Get a
</span><a href="Codec.Candid.Decode.html#getLEB128Int"><span class="hs-identifier hs-var">getLEB128Int</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><span class="annottext">Natural -&gt; Get ()
</span><a href="Codec.Candid.Decode.html#checkOvershoot"><span class="hs-identifier hs-var">checkOvershoot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href=".."><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679403454"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><span class="annottext">Integer -&gt; a -&gt; Get a
forall t. (Eq t, Num t) =&gt; t -&gt; a -&gt; Get a
</span><a href="#local-6989586621679403453"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679403454"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403455"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621679403453"><span class="annot"><span class="annottext">go :: t -&gt; a -&gt; Get a
</span><a href="#local-6989586621679403453"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679403452"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403452"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403452"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><a href="#local-6989586621679403453"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679403451"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679403451"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679403450"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403450"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Get a
</span><a href="#local-6989586621679403456"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403450"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Get a -&gt; (a -&gt; Get a) -&gt; Get a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; a -&gt; Get a
</span><a href="#local-6989586621679403453"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679403451"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href=".."><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeTypTable"><span class="hs-identifier hs-type">decodeTypTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.TypTable.html#SeqDesc"><span class="hs-identifier hs-type">SeqDesc</span></a></span><span>
</span><span id="line-153"></span><span id="decodeTypTable"><span class="annot"><span class="annottext">decodeTypTable :: Get SeqDesc
</span><a href="Codec.Candid.Decode.html#decodeTypTable"><span class="hs-identifier hs-var hs-var">decodeTypTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-154"></span><span>    </span><span id="local-6989586621679403449"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403449"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Natural
forall a. LEB128 a =&gt; Get a
</span><a href=".."><span class="hs-identifier hs-var">getLEB128</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">Natural -&gt; Get ()
</span><a href="Codec.Candid.Decode.html#checkOvershoot"><span class="hs-identifier hs-var">checkOvershoot</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403449"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621679403448"><span class="annot"><span class="annottext">[Either (Type Int) PreService]
</span><a href="#local-6989586621679403448"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Get (Either (Type Int) PreService)
-&gt; Get [Either (Type Int) PreService]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href=".."><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href=".."><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403449"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Get (Either (Type Int) PreService)
</span><a href="Codec.Candid.Decode.html#decodeTypTableEntry"><span class="hs-identifier hs-var">decodeTypTableEntry</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403449"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621679403446"><span class="annot"><span class="annottext">[Type Int]
</span><a href="#local-6989586621679403446"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Either (Type Int) PreService] -&gt; Get [Type Int]
</span><a href="Codec.Candid.Decode.html#resolveServiceT"><span class="hs-identifier hs-var">resolveServiceT</span></a></span><span> </span><span class="annot"><span class="annottext">[Either (Type Int) PreService]
</span><a href="#local-6989586621679403448"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679403444"><span class="annot"><span class="annottext">m :: Map Int (Type Int)
</span><a href="#local-6989586621679403444"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int, Type Int)] -&gt; Map Int (Type Int)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href=".."><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; [Type Int] -&gt; [(Int, Type Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href=".."><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Type Int]
</span><a href="#local-6989586621679403446"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679403442"><span class="annot"><span class="annottext">[Type Int]
</span><a href="#local-6989586621679403442"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get (Type Int) -&gt; Get [Type Int]
forall a. Get a -&gt; Get [a]
</span><a href="Codec.Candid.Decode.html#decodeSeq"><span class="hs-identifier hs-var">decodeSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Get (Type Int)
</span><a href="Codec.Candid.Decode.html#decodeTypRef"><span class="hs-identifier hs-var">decodeTypRef</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403449"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><span class="annottext">SeqDesc -&gt; Get SeqDesc
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(SeqDesc -&gt; Get SeqDesc) -&gt; SeqDesc -&gt; Get SeqDesc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map Int (Type Int) -&gt; [Type Int] -&gt; SeqDesc
forall k.
(Pretty k, Ord k) =&gt;
Map k (Type k) -&gt; [Type k] -&gt; SeqDesc
</span><a href="Codec.Candid.TypTable.html#SeqDesc"><span class="hs-identifier hs-var">SeqDesc</span></a></span><span> </span><span class="annot"><span class="annottext">Map Int (Type Int)
</span><a href="#local-6989586621679403444"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[Type Int]
</span><a href="#local-6989586621679403442"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-keyword">type</span><span> </span><span id="PreService"><span class="annot"><a href="Codec.Candid.Decode.html#PreService"><span class="hs-identifier hs-var">PreService</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeTypTableEntry"><span class="hs-identifier hs-type">decodeTypTableEntry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Codec.Candid.Decode.html#PreService"><span class="hs-identifier hs-type">PreService</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span id="decodeTypTableEntry"><span class="annot"><span class="annottext">decodeTypTableEntry :: Natural -&gt; Get (Either (Type Int) PreService)
</span><a href="Codec.Candid.Decode.html#decodeTypTableEntry"><span class="hs-identifier hs-var hs-var">decodeTypTableEntry</span></a></span></span><span> </span><span id="local-6989586621679403439"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403439"><span class="hs-identifier hs-var">max</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SLEB128 Integer =&gt; Get Integer
forall a. SLEB128 a =&gt; Get a
</span><a href=".."><span class="hs-identifier hs-var">getSLEB128</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="annot"><span class="annottext">Get Integer
-&gt; (Integer -&gt; Get (Either (Type Int) PreService))
-&gt; Get (Either (Type Int) PreService)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-glyph">-</span><span class="hs-number">18</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type Int -&gt; Either (Type Int) PreService
forall a b. a -&gt; Either a b
</span><a href=".."><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(Type Int -&gt; Either (Type Int) PreService)
-&gt; (Type Int -&gt; Type Int)
-&gt; Type Int
-&gt; Either (Type Int) PreService
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href=".."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Type Int -&gt; Type Int
forall a. Type a -&gt; Type a
</span><a href="Codec.Candid.Types.html#OptT"><span class="hs-identifier hs-var">OptT</span></a></span><span> </span><span class="annot"><span class="annottext">(Type Int -&gt; Either (Type Int) PreService)
-&gt; Get (Type Int) -&gt; Get (Either (Type Int) PreService)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Get (Type Int)
</span><a href="Codec.Candid.Decode.html#decodeTypRef"><span class="hs-identifier hs-var">decodeTypRef</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403439"><span class="hs-identifier hs-var">max</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-glyph">-</span><span class="hs-number">19</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-168"></span><span>        </span><span id="local-6989586621679403438"><span class="annot"><span class="annottext">Type Int
</span><a href="#local-6989586621679403438"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Get (Type Int)
</span><a href="Codec.Candid.Decode.html#decodeTypRef"><span class="hs-identifier hs-var">decodeTypRef</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403439"><span class="hs-identifier hs-var">max</span></a></span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><span class="annottext">Either (Type Int) PreService -&gt; Get (Either (Type Int) PreService)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (Type Int) PreService
 -&gt; Get (Either (Type Int) PreService))
-&gt; Either (Type Int) PreService
-&gt; Get (Either (Type Int) PreService)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Type Int
</span><a href="#local-6989586621679403438"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Type Int -&gt; Type Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Type Int
forall a. Type a
</span><a href="Codec.Candid.Types.html#Nat8T"><span class="hs-identifier hs-var">Nat8T</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Type Int -&gt; Either (Type Int) PreService
forall a b. a -&gt; Either a b
</span><a href=".."><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">Type Int
forall a. Type a
</span><a href="Codec.Candid.Types.html#BlobT"><span class="hs-identifier hs-var">BlobT</span></a></span><span>
</span><span id="line-170"></span><span>                             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Type Int -&gt; Either (Type Int) PreService
forall a b. a -&gt; Either a b
</span><a href=".."><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type Int -&gt; Type Int
forall a. Type a -&gt; Type a
</span><a href="Codec.Candid.Types.html#VecT"><span class="hs-identifier hs-var">VecT</span></a></span><span> </span><span class="annot"><span class="annottext">Type Int
</span><a href="#local-6989586621679403438"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-glyph">-</span><span class="hs-number">20</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type Int -&gt; Either (Type Int) PreService
forall a b. a -&gt; Either a b
</span><a href=".."><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(Type Int -&gt; Either (Type Int) PreService)
-&gt; (Fields Int -&gt; Type Int)
-&gt; Fields Int
-&gt; Either (Type Int) PreService
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href=".."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Int -&gt; Type Int
forall a. Fields a -&gt; Type a
</span><a href="Codec.Candid.Types.html#RecT"><span class="hs-identifier hs-var">RecT</span></a></span><span> </span><span class="annot"><span class="annottext">(Fields Int -&gt; Either (Type Int) PreService)
-&gt; Get (Fields Int) -&gt; Get (Either (Type Int) PreService)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Get (Fields Int)
</span><a href="Codec.Candid.Decode.html#decodeTypFields"><span class="hs-identifier hs-var">decodeTypFields</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403439"><span class="hs-identifier hs-var">max</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-glyph">-</span><span class="hs-number">21</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type Int -&gt; Either (Type Int) PreService
forall a b. a -&gt; Either a b
</span><a href=".."><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(Type Int -&gt; Either (Type Int) PreService)
-&gt; (Fields Int -&gt; Type Int)
-&gt; Fields Int
-&gt; Either (Type Int) PreService
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href=".."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Int -&gt; Type Int
forall a. Fields a -&gt; Type a
</span><a href="Codec.Candid.Types.html#VariantT"><span class="hs-identifier hs-var">VariantT</span></a></span><span> </span><span class="annot"><span class="annottext">(Fields Int -&gt; Either (Type Int) PreService)
-&gt; Get (Fields Int) -&gt; Get (Either (Type Int) PreService)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Get (Fields Int)
</span><a href="Codec.Candid.Decode.html#decodeTypFields"><span class="hs-identifier hs-var">decodeTypFields</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403439"><span class="hs-identifier hs-var">max</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-glyph">-</span><span class="hs-number">22</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-174"></span><span>        </span><span id="local-6989586621679403436"><span class="annot"><span class="annottext">[Type Int]
</span><a href="#local-6989586621679403436"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get (Type Int) -&gt; Get [Type Int]
forall a. Get a -&gt; Get [a]
</span><a href="Codec.Candid.Decode.html#decodeSeq"><span class="hs-identifier hs-var">decodeSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Get (Type Int)
</span><a href="Codec.Candid.Decode.html#decodeTypRef"><span class="hs-identifier hs-var">decodeTypRef</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403439"><span class="hs-identifier hs-var">max</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>        </span><span id="local-6989586621679403435"><span class="annot"><span class="annottext">[Type Int]
</span><a href="#local-6989586621679403435"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get (Type Int) -&gt; Get [Type Int]
forall a. Get a -&gt; Get [a]
</span><a href="Codec.Candid.Decode.html#decodeSeq"><span class="hs-identifier hs-var">decodeSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Get (Type Int)
</span><a href="Codec.Candid.Decode.html#decodeTypRef"><span class="hs-identifier hs-var">decodeTypRef</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403439"><span class="hs-identifier hs-var">max</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>        </span><span id="local-6989586621679403434"><span class="annot"><span class="annottext">MethodType Int
</span><a href="#local-6989586621679403434"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(MethodType Int -&gt; Get (MethodType Int))
-&gt; MethodType Int -&gt; Get (MethodType Int)
forall a. (a -&gt; Get a) -&gt; a -&gt; Get a
</span><a href="Codec.Candid.Decode.html#decodeFoldSeq"><span class="hs-identifier hs-var">decodeFoldSeq</span></a></span><span> </span><span class="annot"><span class="annottext">MethodType Int -&gt; Get (MethodType Int)
forall t. MethodType t -&gt; Get (MethodType t)
</span><a href="Codec.Candid.Decode.html#decodeFuncAnn"><span class="hs-identifier hs-var">decodeFuncAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type Int] -&gt; [Type Int] -&gt; Bool -&gt; Bool -&gt; Bool -&gt; MethodType Int
forall a.
[Type a] -&gt; [Type a] -&gt; Bool -&gt; Bool -&gt; Bool -&gt; MethodType a
</span><a href="Codec.Candid.Types.html#MethodType"><span class="hs-identifier hs-var">MethodType</span></a></span><span> </span><span class="annot"><span class="annottext">[Type Int]
</span><a href="#local-6989586621679403436"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[Type Int]
</span><a href="#local-6989586621679403435"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="annottext">Either (Type Int) PreService -&gt; Get (Either (Type Int) PreService)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (Type Int) PreService
 -&gt; Get (Either (Type Int) PreService))
-&gt; Either (Type Int) PreService
-&gt; Get (Either (Type Int) PreService)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Type Int -&gt; Either (Type Int) PreService
forall a b. a -&gt; Either a b
</span><a href=".."><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodType Int -&gt; Type Int
forall a. MethodType a -&gt; Type a
</span><a href="Codec.Candid.Types.html#FuncT"><span class="hs-identifier hs-var">FuncT</span></a></span><span> </span><span class="annot"><span class="annottext">MethodType Int
</span><a href="#local-6989586621679403434"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-glyph">-</span><span class="hs-number">23</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>        </span><span id="local-6989586621679403431"><span class="annot"><span class="annottext">PreService
</span><a href="#local-6989586621679403431"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get (Text, Int) -&gt; Get PreService
forall a. Get a -&gt; Get [a]
</span><a href="Codec.Candid.Decode.html#decodeSeq"><span class="hs-identifier hs-var">decodeSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Int -&gt; (Text, Int))
-&gt; Get Text -&gt; Get (Int -&gt; (Text, Int))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Get Text
</span><a href="Codec.Candid.Decode.html#decodeText"><span class="hs-identifier hs-var">decodeText</span></a></span><span> </span><span class="annot"><span class="annottext">Get (Int -&gt; (Text, Int)) -&gt; Get Int -&gt; Get (Text, Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Get Int
</span><a href="Codec.Candid.Decode.html#decodeFuncTypRef"><span class="hs-identifier hs-var">decodeFuncTypRef</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403439"><span class="hs-identifier hs-var">max</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Get () -&gt; Get ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Bool
forall a. Ord a =&gt; [a] -&gt; Bool
</span><a href="Codec.Candid.Decode.html#isOrdered"><span class="hs-identifier hs-var">isOrdered</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Text, Int) -&gt; Text) -&gt; PreService -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href=".."><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Text, Int) -&gt; Text
forall a b. (a, b) -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">PreService
</span><a href="#local-6989586621679403431"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Get () -&gt; Get ()) -&gt; Get () -&gt; Get ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-181"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; Get ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Service methods not in strict order&quot;</span></span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><span class="annottext">Either (Type Int) PreService -&gt; Get (Either (Type Int) PreService)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PreService -&gt; Either (Type Int) PreService
forall a b. b -&gt; Either a b
</span><a href=".."><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">PreService
</span><a href="#local-6989586621679403431"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Int64
forall a. Integral a =&gt; Get a
</span><a href="Codec.Candid.Decode.html#getLEB128Int"><span class="hs-identifier hs-var">getLEB128Int</span></a></span><span> </span><span class="annot"><span class="annottext">Get Int64 -&gt; (Int64 -&gt; Get ByteString) -&gt; Get ByteString
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Get ByteString
</span><a href=".."><span class="hs-identifier hs-var">G.getLazyByteString</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><span class="annottext">Either (Type Int) PreService -&gt; Get (Either (Type Int) PreService)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type Int -&gt; Either (Type Int) PreService
forall a b. a -&gt; Either a b
</span><a href=".."><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">Type Int
forall a. Type a
</span><a href="Codec.Candid.Types.html#FutureT"><span class="hs-identifier hs-var">FutureT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeTypRef"><span class="hs-identifier hs-type">decodeTypRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span id="decodeTypRef"><span class="annot"><span class="annottext">decodeTypRef :: Natural -&gt; Get (Type Int)
</span><a href="Codec.Candid.Decode.html#decodeTypRef"><span class="hs-identifier hs-var hs-var">decodeTypRef</span></a></span></span><span> </span><span id="local-6989586621679403428"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403428"><span class="hs-identifier hs-var">max</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679403427"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679403427"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Integer
forall a. SLEB128 a =&gt; Get a
</span><a href=".."><span class="hs-identifier hs-var">getSLEB128</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Get () -&gt; Get ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679403427"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href=".."><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403428"><span class="hs-identifier hs-var">max</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Get () -&gt; Get ()) -&gt; Get () -&gt; Get ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Get ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Type reference out of range&quot;</span></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679403427"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe (Type Int)
forall a. Integer -&gt; Maybe (Type a)
</span><a href="Codec.Candid.Types.html#primTyp"><span class="hs-identifier hs-var">primTyp</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679403427"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-193"></span><span>        </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679403425"><span class="annot"><span class="annottext">Type Int
</span><a href="#local-6989586621679403425"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type Int -&gt; Get (Type Int)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Type Int
</span><a href="#local-6989586621679403425"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-194"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Type Int)
</span><a href=".."><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get (Type Int)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Get (Type Int)) -&gt; String -&gt; Get (Type Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unknown prim typ &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679403427"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Type Int -&gt; Get (Type Int)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Type Int -&gt; Get (Type Int)) -&gt; Type Int -&gt; Get (Type Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type Int
forall a. a -&gt; Type a
</span><a href="Codec.Candid.Types.html#RefT"><span class="hs-identifier hs-var">RefT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href=".."><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679403427"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeFuncTypRef"><span class="hs-identifier hs-type">decodeFuncTypRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-198"></span><span id="decodeFuncTypRef"><span class="annot"><span class="annottext">decodeFuncTypRef :: Natural -&gt; Get Int
</span><a href="Codec.Candid.Decode.html#decodeFuncTypRef"><span class="hs-identifier hs-var hs-var">decodeFuncTypRef</span></a></span></span><span> </span><span id="local-6989586621679403424"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403424"><span class="hs-identifier hs-var">max</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621679403423"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679403423"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Integer
forall a. SLEB128 a =&gt; Get a
</span><a href=".."><span class="hs-identifier hs-var">getSLEB128</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Get () -&gt; Get ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679403423"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href=".."><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403424"><span class="hs-identifier hs-var">max</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Get () -&gt; Get ()) -&gt; Get () -&gt; Get ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Get ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Type reference out of range&quot;</span></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679403423"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe (Type Any)
forall a. Integer -&gt; Maybe (Type a)
</span><a href="Codec.Candid.Types.html#primTyp"><span class="hs-identifier hs-var">primTyp</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679403423"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Type Any
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get Int
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Primitive type as method type in service type&quot;</span></span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Type Any)
</span><a href=".."><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get Int
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Get Int) -&gt; String -&gt; Get Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unknown prim typ &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href=".."><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679403423"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get Int
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Get Int) -&gt; Int -&gt; Get Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href=".."><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679403423"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- This resolves PreServiceT to ServiceT</span><span>
</span><span id="line-208"></span><span class="annot"><a href="Codec.Candid.Decode.html#resolveServiceT"><span class="hs-identifier hs-type">resolveServiceT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Codec.Candid.Decode.html#PreService"><span class="hs-identifier hs-type">PreService</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span id="resolveServiceT"><span class="annot"><span class="annottext">resolveServiceT :: [Either (Type Int) PreService] -&gt; Get [Type Int]
</span><a href="Codec.Candid.Decode.html#resolveServiceT"><span class="hs-identifier hs-var hs-var">resolveServiceT</span></a></span></span><span> </span><span id="local-6989586621679403422"><span class="annot"><span class="annottext">[Either (Type Int) PreService]
</span><a href="#local-6989586621679403422"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either (Type Int) PreService -&gt; Get (Type Int))
-&gt; [Either (Type Int) PreService] -&gt; Get [Type Int]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href=".."><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Either (Type Int) PreService -&gt; Get (Type Int)
forall (f :: * -&gt; *).
MonadFail f =&gt;
Either (Type Int) PreService -&gt; f (Type Int)
</span><a href="#local-6989586621679403421"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Either (Type Int) PreService]
</span><a href="#local-6989586621679403422"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>    </span><span id="local-6989586621679403420"><span class="annot"><span class="annottext">m :: Map Int (Either (Type Int) PreService)
</span><a href="#local-6989586621679403420"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int, Either (Type Int) PreService)]
-&gt; Map Int (Either (Type Int) PreService)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href=".."><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int]
-&gt; [Either (Type Int) PreService]
-&gt; [(Int, Either (Type Int) PreService)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href=".."><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Either (Type Int) PreService]
</span><a href="#local-6989586621679403422"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679403421"><span class="annot"><span class="annottext">go :: Either (Type Int) PreService -&gt; f (Type Int)
</span><a href="#local-6989586621679403421"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679403419"><span class="annot"><span class="annottext">Type Int
</span><a href="#local-6989586621679403419"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type Int -&gt; f (Type Int)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href=".."><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Type Int
</span><a href="#local-6989586621679403419"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><a href="#local-6989586621679403421"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679403418"><span class="annot"><span class="annottext">PreService
</span><a href="#local-6989586621679403418"><span class="hs-identifier hs-var">is</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Text, MethodType Int)] -&gt; Type Int
forall a. [(Text, MethodType a)] -&gt; Type a
</span><a href="Codec.Candid.Types.html#ServiceT"><span class="hs-identifier hs-var">ServiceT</span></a></span><span> </span><span class="annot"><span class="annottext">([(Text, MethodType Int)] -&gt; Type Int)
-&gt; f [(Text, MethodType Int)] -&gt; f (Type Int)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((Text, Int) -&gt; f (Text, MethodType Int))
-&gt; PreService -&gt; f [(Text, MethodType Int)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href=".."><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">(Text, Int) -&gt; f (Text, MethodType Int)
forall (m :: * -&gt; *) a.
MonadFail m =&gt;
(a, Int) -&gt; m (a, MethodType Int)
</span><a href="#local-6989586621679403417"><span class="hs-identifier hs-var">goMethod</span></a></span><span> </span><span class="annot"><span class="annottext">PreService
</span><a href="#local-6989586621679403418"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621679403417"><span class="annot"><span class="annottext">goMethod :: (a, Int) -&gt; m (a, MethodType Int)
</span><a href="#local-6989586621679403417"><span class="hs-identifier hs-var hs-var">goMethod</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679403416"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403416"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679403415"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403415"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map Int (Either (Type Int) PreService)
</span><a href="#local-6989586621679403420"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Map Int (Either (Type Int) PreService)
-&gt; Int -&gt; Either (Type Int) PreService
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href=".."><span class="hs-operator hs-var">M.!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403415"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#FuncT"><span class="hs-identifier hs-type">FuncT</span></a></span><span> </span><span id="local-6989586621679403413"><span class="annot"><span class="annottext">MethodType Int
</span><a href="#local-6989586621679403413"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, MethodType Int) -&gt; m (a, MethodType Int)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403416"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">MethodType Int
</span><a href="#local-6989586621679403413"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><span class="annottext">Either (Type Int) PreService
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; m (a, MethodType Int)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Method type not a function type&quot;</span></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span id="local-6989586621679403614"><span class="annot"><a href="Codec.Candid.Decode.html#decodeFuncAnn"><span class="hs-identifier hs-type">decodeFuncAnn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#MethodType"><span class="hs-identifier hs-type">MethodType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403614"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#MethodType"><span class="hs-identifier hs-type">MethodType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403614"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-222"></span><span id="decodeFuncAnn"><span class="annot"><span class="annottext">decodeFuncAnn :: MethodType t -&gt; Get (MethodType t)
</span><a href="Codec.Candid.Decode.html#decodeFuncAnn"><span class="hs-identifier hs-var hs-var">decodeFuncAnn</span></a></span></span><span> </span><span id="local-6989586621679403412"><span class="annot"><span class="annottext">MethodType t
</span><a href="#local-6989586621679403412"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><a href=".."><span class="hs-identifier hs-var">G.getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">Get Word8 -&gt; (Word8 -&gt; Get (MethodType t)) -&gt; Get (MethodType t)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href=".."><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Get () -&gt; Get ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodType t -&gt; Bool
forall a. MethodType a -&gt; Bool
</span><a href="Codec.Candid.Types.html#methQuery"><span class="hs-identifier hs-var hs-var">methQuery</span></a></span><span> </span><span class="annot"><span class="annottext">MethodType t
</span><a href="#local-6989586621679403412"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Get () -&gt; Get ()) -&gt; Get () -&gt; Get ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Get ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;query annotation duplicated&quot;</span></span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><span class="annottext">MethodType t -&gt; Get (MethodType t)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodType t
</span><a href="#local-6989586621679403412"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">methQuery :: Bool
</span><a href="Codec.Candid.Types.html#methQuery"><span class="hs-identifier hs-var">methQuery</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-227"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Get () -&gt; Get ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodType t -&gt; Bool
forall a. MethodType a -&gt; Bool
</span><a href="Codec.Candid.Types.html#methOneway"><span class="hs-identifier hs-var hs-var">methOneway</span></a></span><span> </span><span class="annot"><span class="annottext">MethodType t
</span><a href="#local-6989586621679403412"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Get () -&gt; Get ()) -&gt; Get () -&gt; Get ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Get ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;oneway annotation duplicated&quot;</span></span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><span class="annottext">MethodType t -&gt; Get (MethodType t)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodType t
</span><a href="#local-6989586621679403412"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">methOneway :: Bool
</span><a href="Codec.Candid.Types.html#methOneway"><span class="hs-identifier hs-var">methOneway</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Get () -&gt; Get ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodType t -&gt; Bool
forall a. MethodType a -&gt; Bool
</span><a href="Codec.Candid.Types.html#methCompQuery"><span class="hs-identifier hs-var hs-var">methCompQuery</span></a></span><span> </span><span class="annot"><span class="annottext">MethodType t
</span><a href="#local-6989586621679403412"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Get () -&gt; Get ()) -&gt; Get () -&gt; Get ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Get ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;composite_query annotation duplicated&quot;</span></span><span>
</span><span id="line-231"></span><span>        </span><span class="annot"><span class="annottext">MethodType t -&gt; Get (MethodType t)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodType t
</span><a href="#local-6989586621679403412"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">methCompQuery :: Bool
</span><a href="Codec.Candid.Types.html#methCompQuery"><span class="hs-identifier hs-var">methCompQuery</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get (MethodType t)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;invalid function annotation&quot;</span></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span id="local-6989586621679403611"><span class="annot"><a href="Codec.Candid.Decode.html#isOrdered"><span class="hs-identifier hs-type">isOrdered</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403611"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679403611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-236"></span><span id="isOrdered"><span class="annot"><span class="annottext">isOrdered :: [a] -&gt; Bool
</span><a href="Codec.Candid.Decode.html#isOrdered"><span class="hs-identifier hs-var hs-var">isOrdered</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-237"></span><span class="annot"><a href="Codec.Candid.Decode.html#isOrdered"><span class="hs-identifier hs-var">isOrdered</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href=".."><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-238"></span><span class="annot"><a href="Codec.Candid.Decode.html#isOrdered"><span class="hs-identifier hs-var">isOrdered</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679403408"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403408"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><a href=".."><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679403407"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403407"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><a href=".."><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679403406"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679403406"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403408"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403407"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href=".."><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Bool
forall a. Ord a =&gt; [a] -&gt; Bool
</span><a href="Codec.Candid.Decode.html#isOrdered"><span class="hs-identifier hs-var">isOrdered</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679403407"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679403406"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeTypFields"><span class="hs-identifier hs-type">decodeTypFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#Fields"><span class="hs-identifier hs-type">Fields</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span id="decodeTypFields"><span class="annot"><span class="annottext">decodeTypFields :: Natural -&gt; Get (Fields Int)
</span><a href="Codec.Candid.Decode.html#decodeTypFields"><span class="hs-identifier hs-var hs-var">decodeTypFields</span></a></span></span><span> </span><span id="local-6989586621679403404"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403404"><span class="hs-identifier hs-var">max</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-242"></span><span>    </span><span id="local-6989586621679403403"><span class="annot"><span class="annottext">Fields Int
</span><a href="#local-6989586621679403403"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get (FieldName, Type Int) -&gt; Get (Fields Int)
forall a. Get a -&gt; Get [a]
</span><a href="Codec.Candid.Decode.html#decodeSeq"><span class="hs-identifier hs-var">decodeSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Get (FieldName, Type Int)
</span><a href="Codec.Candid.Decode.html#decodeTypField"><span class="hs-identifier hs-var">decodeTypField</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403404"><span class="hs-identifier hs-var">max</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Get () -&gt; Get ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href=".."><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FieldName] -&gt; Bool
forall a. Ord a =&gt; [a] -&gt; Bool
</span><a href="Codec.Candid.Decode.html#isOrdered"><span class="hs-identifier hs-var">isOrdered</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((FieldName, Type Int) -&gt; FieldName) -&gt; Fields Int -&gt; [FieldName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href=".."><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldName, Type Int) -&gt; FieldName
forall a b. (a, b) -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Int
</span><a href="#local-6989586621679403403"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Get () -&gt; Get ()) -&gt; Get () -&gt; Get ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href=".."><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-244"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Get ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Fields not in strict order&quot;</span></span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="annottext">Fields Int -&gt; Get (Fields Int)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Int
</span><a href="#local-6989586621679403403"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeTypField"><span class="hs-identifier hs-type">decodeTypField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">G.Get</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.FieldName.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span id="decodeTypField"><span class="annot"><span class="annottext">decodeTypField :: Natural -&gt; Get (FieldName, Type Int)
</span><a href="Codec.Candid.Decode.html#decodeTypField"><span class="hs-identifier hs-var hs-var">decodeTypField</span></a></span></span><span> </span><span id="local-6989586621679403401"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403401"><span class="hs-identifier hs-var">max</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-249"></span><span>    </span><span id="local-6989586621679403400"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679403400"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word32
forall a. LEB128 a =&gt; Get a
</span><a href=".."><span class="hs-identifier hs-var">getLEB128</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span id="local-6989586621679403399"><span class="annot"><span class="annottext">Type Int
</span><a href="#local-6989586621679403399"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Get (Type Int)
</span><a href="Codec.Candid.Decode.html#decodeTypRef"><span class="hs-identifier hs-var">decodeTypRef</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679403401"><span class="hs-identifier hs-var">max</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><span class="annottext">(FieldName, Type Int) -&gt; Get (FieldName, Type Int)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href=".."><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; FieldName
</span><a href="Codec.Candid.FieldName.html#hashedField"><span class="hs-identifier hs-var">hashedField</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679403400"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type Int
</span><a href="#local-6989586621679403399"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span id="local-6989586621679403665"><span class="annot"><a href="Codec.Candid.Decode.html#decodeZeroBytes"><span class="hs-identifier hs-type">decodeZeroBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403665"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-254"></span><span id="decodeZeroBytes"><span class="annot"><span class="annottext">decodeZeroBytes :: Type a -&gt; Maybe Value
</span><a href="Codec.Candid.Decode.html#decodeZeroBytes"><span class="hs-identifier hs-var hs-var">decodeZeroBytes</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type a
</span><a href="Codec.Candid.Types.html#ReservedT"><span class="hs-identifier hs-var">ReservedT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe Value
forall a. a -&gt; Maybe a
</span><a href=".."><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="Codec.Candid.Types.html#ReservedV"><span class="hs-identifier hs-var">ReservedV</span></a></span><span>
</span><span id="line-255"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeZeroBytes"><span class="hs-identifier hs-var">decodeZeroBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Type a
</span><a href="Codec.Candid.Types.html#NullT"><span class="hs-identifier hs-var">NullT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe Value
forall a. a -&gt; Maybe a
</span><a href=".."><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="Codec.Candid.Types.html#NullV"><span class="hs-identifier hs-var">NullV</span></a></span><span>
</span><span id="line-256"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeZeroBytes"><span class="hs-identifier hs-var">decodeZeroBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#RecT"><span class="hs-identifier hs-type">RecT</span></a></span><span> </span><span id="local-6989586621679403398"><span class="annot"><span class="annottext">Fields a
</span><a href="#local-6989586621679403398"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(FieldName, Value)] -&gt; Value
</span><a href="Codec.Candid.Types.html#RecV"><span class="hs-identifier hs-var">RecV</span></a></span><span> </span><span class="annot"><span class="annottext">([(FieldName, Value)] -&gt; Value)
-&gt; Maybe [(FieldName, Value)] -&gt; Maybe Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((FieldName, Type a) -&gt; Maybe (FieldName, Value))
-&gt; Fields a -&gt; Maybe [(FieldName, Value)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href=".."><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679403397"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679403397"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679403396"><span class="annot"><span class="annottext">Type a
</span><a href="#local-6989586621679403396"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679403397"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Value -&gt; (FieldName, Value))
-&gt; Maybe Value -&gt; Maybe (FieldName, Value)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type a -&gt; Maybe Value
forall a. Type a -&gt; Maybe Value
</span><a href="Codec.Candid.Decode.html#decodeZeroBytes"><span class="hs-identifier hs-var">decodeZeroBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Type a
</span><a href="#local-6989586621679403396"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fields a
</span><a href="#local-6989586621679403395"><span class="hs-identifier hs-var">fs'</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621679403395"><span class="annot"><span class="annottext">fs' :: Fields a
</span><a href="#local-6989586621679403395"><span class="hs-identifier hs-var hs-var">fs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FieldName, Type a) -&gt; FieldName) -&gt; Fields a -&gt; Fields a
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><a href=".."><span class="hs-identifier hs-var">sortOn</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldName, Type a) -&gt; FieldName
forall a b. (a, b) -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">Fields a
</span><a href="#local-6989586621679403398"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-259"></span><span class="annot"><a href="Codec.Candid.Decode.html#decodeZeroBytes"><span class="hs-identifier hs-var">decodeZeroBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Type a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Value
forall a. Maybe a
</span><a href=".."><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">{-
isZeroSizedValue :: Value -&gt; Bool
isZeroSizedValue ReservedV = True
isZeroSizedValue NullV = True
isZeroSizedValue (RecV fs) = all (isZeroSizedValue . snd) fs
isZeroSizedValue (TupV vs) = all isZeroSizedValue vs
isZeroSizedValue _ = False
-}</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="annot"><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-type">countZeroSizeVectors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Candid.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-271"></span><span id="countZeroSizeVectors"><span class="annot"><span class="annottext">countZeroSizeVectors :: Value -&gt; Int
</span><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-var hs-var">countZeroSizeVectors</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#RepeatV"><span class="hs-identifier hs-type">RepeatV</span></a></span><span> </span><span id="local-6989586621679403394"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403394"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679403394"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-272"></span><span class="annot"><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-var">countZeroSizeVectors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#VecV"><span class="hs-identifier hs-type">VecV</span></a></span><span> </span><span id="local-6989586621679403393"><span class="annot"><span class="annottext">Vector Value
</span><a href="#local-6989586621679403393"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Int
</span><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-var">countZeroSizeVectors</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Int) -&gt; Vector Value -&gt; Vector Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Value
</span><a href="#local-6989586621679403393"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span class="annot"><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-var">countZeroSizeVectors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#RecV"><span class="hs-identifier hs-type">RecV</span></a></span><span> </span><span id="local-6989586621679403392"><span class="annot"><span class="annottext">[(FieldName, Value)]
</span><a href="#local-6989586621679403392"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Int
</span><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-var">countZeroSizeVectors</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Int)
-&gt; ((FieldName, Value) -&gt; Value) -&gt; (FieldName, Value) -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href=".."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldName, Value) -&gt; Value
forall a b. (a, b) -&gt; b
</span><a href=".."><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">((FieldName, Value) -&gt; Int) -&gt; [(FieldName, Value)] -&gt; [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(FieldName, Value)]
</span><a href="#local-6989586621679403392"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span class="annot"><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-var">countZeroSizeVectors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#TupV"><span class="hs-identifier hs-type">TupV</span></a></span><span> </span><span id="local-6989586621679403391"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679403391"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href=".."><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Int
</span><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-var">countZeroSizeVectors</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Int) -&gt; [Value] -&gt; [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href=".."><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679403391"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span class="annot"><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-var">countZeroSizeVectors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#VariantV"><span class="hs-identifier hs-type">VariantV</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679403390"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679403390"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Int
</span><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-var">countZeroSizeVectors</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679403390"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-276"></span><span class="annot"><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-var">countZeroSizeVectors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#OptV"><span class="hs-identifier hs-type">OptV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href=".."><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679403389"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679403389"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Int
</span><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-var">countZeroSizeVectors</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679403389"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-277"></span><span class="annot"><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-var">countZeroSizeVectors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Candid.Types.html#AnnV"><span class="hs-identifier hs-type">AnnV</span></a></span><span> </span><span id="local-6989586621679403387"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679403387"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type Void
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Int
</span><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-var">countZeroSizeVectors</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679403387"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-278"></span><span class="annot"><a href="Codec.Candid.Decode.html#countZeroSizeVectors"><span class="hs-identifier hs-var">countZeroSizeVectors</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span></pre></body></html>